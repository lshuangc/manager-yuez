(function(W){var L={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},O={check:{enable:false,autoCheckTrigger:false,chkStyle:L.checkbox.STYLE,nocheckInherit:false,chkDisabledInherit:false,radioType:L.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},E=function(b){var a=B.getRoot(b);a.radioCheckedList=[]},Y=function(a){},N=function(c){var b=c.treeObj,a=J.event;b.bind(a.CHECK,function(e,f,d,g){e.srcEvent=f;G.apply(c.callback.onCheck,[e,d,g])})},C=function(c){var b=c.treeObj,a=J.event;b.unbind(a.CHECK)},M=function(g){var f=g.target,d=B.getSetting(g.data.treeId),i="",b=null,a="",h="",c=null,j=null;if(G.eqs(g.type,"mouseover")){if(d.check.enable&&G.eqs(f.tagName,"span")&&f.getAttribute("treeNode"+J.id.CHECK)!==null){i=G.getNodeMainDom(f).id;a="mouseoverCheck"}}else{if(G.eqs(g.type,"mouseout")){if(d.check.enable&&G.eqs(f.tagName,"span")&&f.getAttribute("treeNode"+J.id.CHECK)!==null){i=G.getNodeMainDom(f).id;a="mouseoutCheck"}}else{if(G.eqs(g.type,"click")){if(d.check.enable&&G.eqs(f.tagName,"span")&&f.getAttribute("treeNode"+J.id.CHECK)!==null){i=G.getNodeMainDom(f).id;a="checkNode"}}}}if(i.length>0){b=B.getNodeCache(d,i);switch(a){case"checkNode":c=P.onCheckNode;break;case"mouseoverCheck":c=P.onMouseoverCheck;break;case"mouseoutCheck":c=P.onMouseoutCheck;break}}var e={stop:a==="checkNode",node:b,nodeEventType:a,nodeEventCallback:c,treeEventType:h,treeEventCallback:j};return e},F=function(d,a,h,g,e,f,i){if(!h){return}var b=d.data.key.checked;if(typeof h[b]=="string"){h[b]=G.eqs(h[b],"true")}h[b]=!!h[b];h.checkedOld=h[b];if(typeof h.nocheck=="string"){h.nocheck=G.eqs(h.nocheck,"true")}h.nocheck=!!h.nocheck||(d.check.nocheckInherit&&g&&!!g.nocheck);if(typeof h.chkDisabled=="string"){h.chkDisabled=G.eqs(h.chkDisabled,"true")}h.chkDisabled=!!h.chkDisabled||(d.check.chkDisabledInherit&&g&&!!g.chkDisabled);if(typeof h.halfCheck=="string"){h.halfCheck=G.eqs(h.halfCheck,"true")}h.halfCheck=!!h.halfCheck;h.check_Child_State=-1;h.check_Focus=false;h.getCheckStatus=function(){return B.getCheckStatus(d,h)};if(d.check.chkStyle==J.radio.STYLE&&d.check.radioType==J.radio.TYPE_ALL&&h[b]){var c=B.getRoot(d);c.radioCheckedList.push(h)}},ab=function(b,a,c){var d=b.data.key.checked;if(b.check.enable){B.makeChkFlag(b,a);c.push("<span ID='",a.tId,J.id.CHECK,"' class='",R.makeChkClass(b,a),"' treeNode",J.id.CHECK,(a.nocheck===true?" style='display:none;'":""),"></span>")}},Q=function(a,b){b.checkNode=function(e,f,d,g){var i=this.setting.data.key.checked;if(e.chkDisabled===true){return}if(f!==true&&f!==false){f=!e[i]}g=!!g;if(e[i]===f&&!d){return}else{if(g&&G.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],true)==false){return}}if(G.uCanDo(this.setting)&&this.setting.check.enable&&e.nocheck!==true){e[i]=f;var h=S(e,J.id.CHECK,this.setting);if(d||this.setting.check.chkStyle===J.radio.STYLE){R.checkNodeRelation(this.setting,e)}R.setChkClass(this.setting,h,e);R.repairParentChkClassWithSelf(this.setting,e);if(g){this.setting.treeObj.trigger(J.event.CHECK,[null,this.setting.treeId,e])}}};b.checkAllNodes=function(d){R.repairAllChk(this.setting,!!d)};b.getCheckedNodes=function(d){var e=this.setting.data.key.children;d=(d!==false);return B.getTreeCheckedNodes(this.setting,B.getRoot(this.setting)[e],d)};b.getChangeCheckedNodes=function(){var d=this.setting.data.key.children;return B.getTreeChangeCheckedNodes(this.setting,B.getRoot(this.setting)[d])};b.setChkDisabled=function(f,g,e,d){g=!!g;e=!!e;d=!!d;R.repairSonChkDisabled(this.setting,f,g,d);R.repairParentChkDisabled(this.setting,f.getParentNode(),g,e)};var c=b.updateNode;b.updateNode=function(e,d){if(c){c.apply(b,arguments)}if(!e||!this.setting.check.enable){return}var g=S(e,this.setting);if(g.get(0)&&G.uCanDo(this.setting)){var f=S(e,J.id.CHECK,this.setting);if(d==true||this.setting.check.chkStyle===J.radio.STYLE){R.checkNodeRelation(this.setting,e)}R.setChkClass(this.setting,f,e);R.repairParentChkClassWithSelf(this.setting,e)}}},K={getRadioCheckedList:function(a){var b=B.getRoot(a).radioCheckedList;for(var c=0,d=b.length;c<d;c++){if(!B.getNodeCache(a,b[c].tId)){b.splice(c,1);c--;d--}}return b},getCheckStatus:function(c,a){if(!c.check.enable||a.nocheck||a.chkDisabled){return null}var d=c.data.key.checked,b={checked:a[d],half:a.halfCheck?a.halfCheck:(c.check.chkStyle==J.radio.STYLE?(a.check_Child_State===2):(a[d]?(a.check_Child_State>-1&&a.check_Child_State<2):(a.check_Child_State>0)))};return b},getTreeCheckedNodes:function(d,b,e,h){if(!b){return[]}var a=d.data.key.children,c=d.data.key.checked,f=(e&&d.check.chkStyle==J.radio.STYLE&&d.check.radioType==J.radio.TYPE_ALL);h=!h?[]:h;for(var g=0,i=b.length;g<i;g++){if(b[g].nocheck!==true&&b[g].chkDisabled!==true&&b[g][c]==e){h.push(b[g]);if(f){break}}B.getTreeCheckedNodes(d,b[g][a],e,h);if(f&&h.length>0){break}}return h},getTreeChangeCheckedNodes:function(b,e,c){if(!e){return[]}var a=b.data.key.children,f=b.data.key.checked;c=!c?[]:c;for(var d=0,g=e.length;d<g;d++){if(e[d].nocheck!==true&&e[d].chkDisabled!==true&&e[d][f]!=e[d].checkedOld){c.push(e[d])}B.getTreeChangeCheckedNodes(b,e[d][a],c)}return c},makeChkFlag:function(e,a){if(!a){return}var b=e.data.key.children,c=e.data.key.checked,h=-1;if(a[b]){for(var f=0,i=a[b].length;f<i;f++){var d=a[b][f];var g=-1;if(e.check.chkStyle==J.radio.STYLE){if(d.nocheck===true||d.chkDisabled===true){g=d.check_Child_State}else{if(d.halfCheck===true){g=2}else{if(d[c]){g=2}else{g=d.check_Child_State>0?2:0}}}if(g==2){h=2;break}else{if(g==0){h=0}}}else{if(e.check.chkStyle==J.checkbox.STYLE){if(d.nocheck===true||d.chkDisabled===true){g=d.check_Child_State}else{if(d.halfCheck===true){g=1}else{if(d[c]){g=(d.check_Child_State===-1||d.check_Child_State===2)?2:1}else{g=(d.check_Child_State>0)?1:0}}}if(g===1){h=1;break}else{if(g===2&&h>-1&&f>0&&g!==h){h=1;break}else{if(h===2&&g>-1&&g<2){h=1;break}else{if(g>-1){h=g}}}}}}}}a.check_Child_State=h}},U={},P={onCheckNode:function(a,b){if(b.chkDisabled===true){return false}var c=B.getSetting(a.data.treeId),e=c.data.key.checked;if(G.apply(c.callback.beforeCheck,[c.treeId,b],true)==false){return true}b[e]=!b[e];R.checkNodeRelation(c,b);var d=S(b,J.id.CHECK,c);R.setChkClass(c,d,b);R.repairParentChkClassWithSelf(c,b);c.treeObj.trigger(J.event.CHECK,[a,c.treeId,b]);return true},onMouseoverCheck:function(a,b){if(b.chkDisabled===true){return false}var c=B.getSetting(a.data.treeId),d=S(b,J.id.CHECK,c);b.check_Focus=true;R.setChkClass(c,d,b);return true},onMouseoutCheck:function(a,b){if(b.chkDisabled===true){return false}var c=B.getSetting(a.data.treeId),d=S(b,J.id.CHECK,c);b.check_Focus=false;R.setChkClass(c,d,b);return true}},T={},X={checkNodeRelation:function(d,j){var f,h,i,a=d.data.key.children,b=d.data.key.checked,c=J.radio;if(d.check.chkStyle==c.STYLE){var e=B.getRadioCheckedList(d);if(j[b]){if(d.check.radioType==c.TYPE_ALL){for(h=e.length-1;h>=0;h--){f=e[h];if(f[b]&&f!=j){f[b]=false;e.splice(h,1);R.setChkClass(d,S(f,J.id.CHECK,d),f);if(f.parentTId!=j.parentTId){R.repairParentChkClassWithSelf(d,f)}}}e.push(j)}else{var g=(j.parentTId)?j.getParentNode():B.getRoot(d);for(h=0,i=g[a].length;h<i;h++){f=g[a][h];if(f[b]&&f!=j){f[b]=false;R.setChkClass(d,S(f,J.id.CHECK,d),f)}}}}else{if(d.check.radioType==c.TYPE_ALL){for(h=0,i=e.length;h<i;h++){if(j==e[h]){e.splice(h,1);break}}}}}else{if(j[b]&&(!j[a]||j[a].length==0||d.check.chkboxType.Y.indexOf("s")>-1)){R.setSonNodeCheckBox(d,j,true)}if(!j[b]&&(!j[a]||j[a].length==0||d.check.chkboxType.N.indexOf("s")>-1)){R.setSonNodeCheckBox(d,j,false)}if(j[b]&&d.check.chkboxType.Y.indexOf("p")>-1){R.setParentNodeCheckBox(d,j,true)}if(!j[b]&&d.check.chkboxType.N.indexOf("p")>-1){R.setParentNodeCheckBox(d,j,false)}}},makeChkClass:function(f,c){var g=f.data.key.checked,a=J.checkbox,d=J.radio,b="";if(c.chkDisabled===true){b=a.DISABLED}else{if(c.halfCheck){b=a.PART}else{if(f.check.chkStyle==d.STYLE){b=(c.check_Child_State<1)?a.FULL:a.PART}else{b=c[g]?((c.check_Child_State===2||c.check_Child_State===-1)?a.FULL:a.PART):((c.check_Child_State<1)?a.FULL:a.PART)}}}var e=f.check.chkStyle+"_"+(c[g]?a.TRUE:a.FALSE)+"_"+b;e=(c.check_Focus&&c.chkDisabled!==true)?e+"_"+a.FOCUS:e;return J.className.BUTTON+" "+a.DEFAULT+" "+e},repairAllChk:function(d,a){if(d.check.enable&&d.check.chkStyle===J.checkbox.STYLE){var f=d.data.key.checked,b=d.data.key.children,g=B.getRoot(d);for(var e=0,h=g[b].length;e<h;e++){var c=g[b][e];if(c.nocheck!==true&&c.chkDisabled!==true){c[f]=a}R.setSonNodeCheckBox(d,c,a)}}},repairChkClass:function(b,a){if(!a){return}B.makeChkFlag(b,a);if(a.nocheck!==true){var c=S(a,J.id.CHECK,b);R.setChkClass(b,c,a)}},repairParentChkClass:function(b,a){if(!a||!a.parentTId){return}var c=a.getParentNode();R.repairChkClass(b,c);R.repairParentChkClass(b,c)},repairParentChkClassWithSelf:function(c,a){if(!a){return}var b=c.data.key.children;if(a[b]&&a[b].length>0){R.repairParentChkClass(c,a[b][0])}else{R.repairParentChkClass(c,a)}},repairSonChkDisabled:function(c,a,d,f){if(!a){return}var b=c.data.key.children;if(a.chkDisabled!=d){a.chkDisabled=d}R.repairChkClass(c,a);if(a[b]&&f){for(var e=0,g=a[b].length;e<g;e++){var h=a[b][e];R.repairSonChkDisabled(c,h,d,f)}}},repairParentChkDisabled:function(b,a,c,d){if(!a){return}if(a.chkDisabled!=c&&d){a.chkDisabled=c}R.repairChkClass(b,a);R.repairParentChkDisabled(b,a.getParentNode(),c,d)},setChkClass:function(c,a,b){if(!a){return}if(b.nocheck===true){a.hide()}else{a.show()}a.attr("class",R.makeChkClass(c,b))},setParentNodeCheckBox:function(d,k,e,h){var a=d.data.key.children,c=d.data.key.checked,g=S(k,J.id.CHECK,d);if(!h){h=k}B.makeChkFlag(d,k);if(k.nocheck!==true&&k.chkDisabled!==true){k[c]=e;R.setChkClass(d,g,k);if(d.check.autoCheckTrigger&&k!=h){d.treeObj.trigger(J.event.CHECK,[null,d.treeId,k])}}if(k.parentTId){var f=true;if(!e){var b=k.getParentNode()[a];for(var i=0,j=b.length;i<j;i++){if((b[i].nocheck!==true&&b[i].chkDisabled!==true&&b[i][c])||((b[i].nocheck===true||b[i].chkDisabled===true)&&b[i].check_Child_State>0)){f=false;break}}}if(f){R.setParentNodeCheckBox(d,k.getParentNode(),e,h)}}},setSonNodeCheckBox:function(d,k,e,h){if(!k){return}var a=d.data.key.children,c=d.data.key.checked,g=S(k,J.id.CHECK,d);if(!h){h=k}var b=false;if(k[a]){for(var i=0,j=k[a].length;i<j&&k.chkDisabled!==true;i++){var f=k[a][i];R.setSonNodeCheckBox(d,f,e,h);if(f.chkDisabled===true){b=true}}}if(k!=B.getRoot(d)&&k.chkDisabled!==true){if(b&&k.nocheck!==true){B.makeChkFlag(d,k)}if(k.nocheck!==true&&k.chkDisabled!==true){k[c]=e;if(!b){k.check_Child_State=(k[a]&&k[a].length>0)?(e?2:0):-1}}else{k.check_Child_State=-1}R.setChkClass(d,g,k);if(d.check.autoCheckTrigger&&k!=h&&k.nocheck!==true&&k.chkDisabled!==true){d.treeObj.trigger(J.event.CHECK,[null,d.treeId,k])}}}},H={tools:T,view:X,event:U,data:K};W.extend(true,W.fn.zTree.consts,L);W.extend(true,W.fn.zTree._z,H);var Z=W.fn.zTree,G=Z._z.tools,J=Z.consts,R=Z._z.view,B=Z._z.data,I=Z._z.event,S=G.$;B.exSetting(O);B.addInitBind(N);B.addInitUnBind(C);B.addInitCache(Y);B.addInitNode(F);B.addInitProxy(M,true);B.addInitRoot(E);B.addBeforeA(ab);B.addZTreeTools(Q);var D=R.createNodes;R.createNodes=function(b,a,c,d){if(D){D.apply(R,arguments)}if(!c){return}R.repairParentChkClassWithSelf(b,d)};var aa=R.removeNode;R.removeNode=function(b,a){var c=a.getParentNode();if(aa){aa.apply(R,arguments)}if(!a||!c){return}R.repairChkClass(b,c);R.repairParentChkClass(b,c)};var V=R.appendNodes;R.appendNodes=function(c,a,f,g,d,b){var e="";if(V){e=V.apply(R,arguments)}if(g){B.makeChkFlag(c,g)}return e}})(jQuery);