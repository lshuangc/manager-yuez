/*! WebUploader 0.1.5 */
(function(o,q){var r={},s=function(e,d){var b,c,a;if(typeof e==="string"){return p(e)}else{b=[];for(c=e.length,a=0;a<c;a++){b.push(p(e[a]))}return d.apply(null,b)}},k=function(a,b,c){if(arguments.length===2){c=b;b=null}s(b||[],function(){l(a,c,arguments)})},l=function(d,c,b){var a={exports:c},e;if(typeof c==="function"){b.length||(b=[s,a.exports,a]);e=c.apply(null,b);e!==undefined&&(a.exports=e)}r[d]=a.exports},p=function(a){var b=r[a]||o[a];if(!b){throw new Error("`"+a+"` is undefined")}return b},m=function(d){var b,f,e,c,g,a;a=function(h){return h&&(h.charAt(0).toUpperCase()+h.substr(1))};for(b in r){f=d;if(!r.hasOwnProperty(b)){continue}e=b.split("/");g=a(e.pop());while((c=a(e.shift()))){f[c]=f[c]||{};f=f[c]}f[g]=r[b]}return d},t=function(a){o.__dollar=a;return m(q(o,k,s))},n;if(typeof module==="object"&&typeof module.exports==="object"){module.exports=t()}else{if(typeof define==="function"&&define.amd){define(["jquery"],t)}else{n=o.WebUploader;o.WebUploader=t();o.WebUploader.noConflict=function(){o.WebUploader=n}}}})(window,function(d,f,e){f("dollar-third",[],function(){var a=d.__dollar||d.jQuery||d.Zepto;if(!a){throw new Error("jQuery or Zepto not found!")}return a});f("dollar",["dollar-third"],function(a){return a});f("promise-third",["dollar"],function(a){return{Deferred:a.Deferred,when:a.when,isPromise:function(b){return b&&typeof b.then==="function"}}});f("promise",["promise-third"],function(a){return a});f("base",["dollar","promise"],function(c,a){var k=function(){},l=Function.call;function m(g){return function(){return l.apply(g,arguments)}}function b(g,h){return function(){return g.apply(h,arguments)}}function n(h){var g;if(Object.create){return Object.create(h)}else{g=function(){};g.prototype=h;return new g()}}return{version:"0.1.5",$:c,Deferred:a.Deferred,isPromise:a.isPromise,when:a.when,browser:(function(u){var v={},g=u.match(/WebKit\/([\d.]+)/),i=u.match(/Chrome\/([\d.]+)/)||u.match(/CriOS\/([\d.]+)/),j=u.match(/MSIE\s([\d\.]+)/)||u.match(/(?:trident)(?:.*rv:([\w.]+))?/i),t=u.match(/Firefox\/([\d.]+)/),s=u.match(/Safari\/([\d.]+)/),h=u.match(/OPR\/([\d.]+)/);g&&(v.webkit=parseFloat(g[1]));i&&(v.chrome=parseFloat(i[1]));j&&(v.ie=parseFloat(j[1]));t&&(v.firefox=parseFloat(t[1]));s&&(v.safari=parseFloat(s[1]));h&&(v.opera=parseFloat(h[1]));return v})(navigator.userAgent),os:(function(g){var h={},i=g.match(/(?:Android);?[\s\/]+([\d.]+)?/),j=g.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);i&&(h.android=parseFloat(i[1]));j&&(h.ios=parseFloat(j[1].replace(/_/g,".")));return h})(navigator.userAgent),inherits:function(g,h,i){var j;if(typeof h==="function"){j=h;h=null}else{if(h&&h.hasOwnProperty("constructor")){j=h.constructor}else{j=function(){return g.apply(this,arguments)}}}c.extend(true,j,g,i||{});j.__super__=g.prototype;j.prototype=n(g.prototype);h&&c.extend(true,j.prototype,h);return j},noop:k,bindFn:b,log:(function(){if(d.console){return b(console.log,console)}return k})(),nextTick:(function(){return function(g){setTimeout(g,1)}})(),slice:m([].slice),guid:(function(){var g=0;return function(j){var i=(+new Date()).toString(32),h=0;for(;h<5;h++){i+=Math.floor(Math.random()*65535).toString(32)}return(j||"wu_")+i+(g++).toString(32)}})(),formatSize:function(g,i,h){var j;h=h||["B","K","M","G","TB"];while((j=h.shift())&&g>1024){g=g/1024}return(j==="B"?g:g.toFixed(i||2))+j}}});f("mediator",["base"],function(n){var m=n.$,a=[].slice,b=/\s+/,o;function p(h,g,i,j){return m.grep(h,function(k){return k&&(!g||k.e===g)&&(!i||k.cb===i||k.cb._cb===i)&&(!j||k.ctx===j)})}function c(h,i,g){m.each((h||"").split(b),function(k,j){g(j,i)})}function l(j,r){var g=false,k=-1,h=j.length,i;while(++k<h){i=j[k];if(i.cb.apply(i.ctx2,r)===false){g=true;break}}return !g}o={on:function(h,i,g){var k=this,j;if(!i){return this}j=this._events||(this._events=[]);c(h,i,function(v,t){var u={e:v};u.cb=t;u.ctx=g;u.ctx2=g||k;u.id=j.length;j.push(u)});return this},once:function(h,i,g){var j=this;if(!i){return j}c(h,i,function(t,k){var s=function(){j.off(t,s);return k.apply(g||j,arguments)};s._cb=k;j.on(t,s,g)});return j},off:function(j,h,g){var i=this._events;if(!i){return this}if(!j&&!h&&!g){this._events=[];return this}c(j,h,function(k,r){m.each(p(i,k,r,g),function(){delete i[this.id]})});return this},trigger:function(i){var g,j,h;if(!this._events||!i){return this}g=a.call(arguments,1);j=p(this._events,i);h=p(this._events,"all");return l(j,g)&&l(h,arguments)}};return m.extend({installTo:function(g){return m.extend(g,o)}},o)});f("uploader",["base","mediator"],function(h,b){var c=h.$;function a(g){this.options=c.extend(true,{},a.options,g);this._init(this.options)}a.options={};b.installTo(a.prototype);c.each({upload:"start-upload",stop:"stop-upload",getFile:"get-file",getFiles:"get-files",addFile:"add-file",addFiles:"add-file",sort:"sort-files",removeFile:"remove-file",cancelFile:"cancel-file",skipFile:"skip-file",retry:"retry",isInProgress:"is-in-progress",makeThumb:"make-thumb",md5File:"md5-file",getDimension:"get-dimension",addButton:"add-btn",predictRuntimeType:"predict-runtime-type",refresh:"refresh",disable:"disable",enable:"enable",reset:"reset"},function(j,g){a.prototype[j]=function(){return this.request(g,arguments)}});c.extend(a.prototype,{state:"pending",_init:function(g){var j=this;j.request("init",g,function(){j.state="ready";j.trigger("ready")})},option:function(l,g){var k=this.options;if(arguments.length>1){if(c.isPlainObject(g)&&c.isPlainObject(k[l])){c.extend(k[l],g)}else{k[l]=g}}else{return l?k[l]:k}},getStats:function(){var g=this.request("get-stats");return g?{successNum:g.numOfSuccess,progressNum:g.numOfProgress,cancelNum:g.numOfCancel,invalidNum:g.numOfInvalid,uploadFailNum:g.numOfUploadFailed,queueNum:g.numOfQueue,interruptNum:g.numofInterrupt}:{}},trigger:function(l){var m=[].slice.call(arguments,1),g=this.options,n="on"+l.substring(0,1).toUpperCase()+l.substring(1);if(b.trigger.apply(this,arguments)===false||c.isFunction(g[n])&&g[n].apply(this,m)===false||c.isFunction(this[n])&&this[n].apply(this,m)===false||b.trigger.apply(b,[this,l].concat(m))===false){return false}return true},destroy:function(){this.request("destroy",arguments);this.off()},request:h.noop});h.create=a.create=function(g){return new a(g)};h.Uploader=a;return a});f("runtime/runtime",["base","mediator"],function(k,b){var c=k.$,j={},a=function(g){for(var h in g){if(g.hasOwnProperty(h)){return h}}return null};function l(g){this.options=c.extend({container:document.body},g);this.uid=k.guid("rt_")}c.extend(l.prototype,{getContainer:function(){var g=this.options,h,i;if(this._container){return this._container}h=c(g.container||document.body);i=c(document.createElement("div"));i.attr("id","rt_"+this.uid);i.css({position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"});h.append(i);h.addClass("webuploader-container");this._container=i;this._parent=h;return i},init:k.noop,exec:k.noop,destroy:function(){this._container&&this._container.remove();this._parent&&this._parent.removeClass("webuploader-container");this.off()}});l.orders="html5,flash";l.addRuntime=function(g,h){j[g]=h};l.hasRuntime=function(g){return !!(g?j[g]:a(j))};l.create=function(g,i){var n,h;i=i||l.orders;c.each(i.split(/\s*,\s*/g),function(){if(j[this]){n=this;return false}});n=n||a(j);if(!n){throw new Error("Runtime Error")}h=new j[n](g);return h};b.installTo(l.prototype);return l});f("runtime/client",["base","mediator","runtime/runtime"],function(b,a,c){var j;j=(function(){var g={};return{add:function(h){g[h.uid]=h},get:function(m,n){var h;if(m){return g[m]}for(h in g){if(n&&g[h].__standalone){continue}return g[h]}return null},remove:function(h){delete g[h.uid]}}})();function i(h,m){var n=b.Deferred(),g;this.uid=b.guid("client_");this.runtimeReady=function(k){return n.done(k)};this.connectRuntime=function(l,k){if(g){throw new Error("already connected!")}n.done(k);if(typeof l==="string"&&j.get(l)){g=j.get(l)}g=g||j.get(null,m);if(!g){g=c.create(l,l.runtimeOrder);g.__promise=n.promise();g.once("ready",n.resolve);g.init();j.add(g);g.__client=1}else{b.$.extend(g.options,l);g.__promise.then(n.resolve);g.__client++}m&&(g.__standalone=m);return g};this.getRuntime=function(){return g};this.disconnectRuntime=function(){if(!g){return}g.__client--;if(g.__client<=0){j.remove(g);delete g.__promise;g.destroy()}g=null};this.exec=function(){if(!g){return}var k=b.slice(arguments);h&&k.unshift(h);return g.exec.apply(this,k)};this.getRuid=function(){return g&&g.uid};this.destroy=(function(k){return function(){k&&k.apply(this,arguments);this.trigger("destroy");this.off();this.exec("destroy");this.disconnectRuntime()}})(this.destroy)}a.installTo(i.prototype);return i});f("lib/dnd",["base","mediator","runtime/client"],function(i,a,j){var c=i.$;function b(g){g=this.options=c.extend({},b.options,g);g.container=c(g.container);if(!g.container.length){return}j.call(this,"DragAndDrop")}b.options={accept:null,disableGlobalDnd:false};i.inherits(j,{constructor:b,init:function(){var g=this;g.connectRuntime(g.options,function(){g.exec("init");g.trigger("ready")})}});a.installTo(b.prototype);return b});f("widgets/widget",["base","uploader"],function(o,q){var p=o.$,m=q.prototype._init,b=q.prototype.destroy,n={},r=[];function a(h){if(!h){return false}var i=h.length,g=p.type(h);if(h.nodeType===1&&i){return true}return g==="array"||g!=="function"&&g!=="string"&&(i===0||typeof i==="number"&&i>0&&(i-1) in h)}function c(g){this.owner=g;this.options=g.options}p.extend(c.prototype,{init:o.noop,invoke:function(g,i){var h=this.responseMap;if(!h||!(g in h)||!(h[g] in this)||!p.isFunction(this[h[g]])){return n}return this[h[g]].apply(this,i)},request:function(){return this.owner.request.apply(this.owner,arguments)}});p.extend(q.prototype,{_init:function(){var h=this,i=h._widgets=[],g=h.options.disableWidgets||"";p.each(r,function(j,k){(!g||!~g.indexOf(k._name))&&i.push(new k(h))});return m.apply(h,arguments)},request:function(k,C,z){var h=0,B=this._widgets,D=B&&B.length,i=[],j=[],g,l,y,A;C=a(C)?C:[C];for(;h<D;h++){g=B[h];l=g.invoke(k,C);if(l!==n){if(o.isPromise(l)){j.push(l)}else{i.push(l)}}}if(z||j.length){y=o.when.apply(o,j);A=y.pipe?"pipe":"then";return y[A](function(){var t=o.Deferred(),s=arguments;if(s.length===1){s=s[0]}setTimeout(function(){t.resolve(s)},1);return t.promise()})[z?A:"done"](z||o.noop)}else{return i[0]}},destroy:function(){b.apply(this,arguments);this._widgets=null}});q.register=c.register=function(j,h){var i={init:"init",destroy:"destroy",name:"anonymous"},g;if(arguments.length===1){h=j;p.each(h,function(k){if(k[0]==="_"||k==="name"){k==="name"&&(i.name=h.name);return}i[k.replace(/[A-Z]/g,"-$&").toLowerCase()]=k})}else{i=p.extend(i,j)}h.responseMap=i;g=o.inherits(c,h);g._name=i.name;r.push(g);return g};q.unRegister=c.unRegister=function(g){if(!g||g==="anonymous"){return}for(var h=r.length;h--;){if(r[h]._name===g){r.splice(h,1)}}};return c});f("widgets/filednd",["base","uploader","lib/dnd","widgets/widget"],function(c,a,h){var b=c.$;a.options.dnd="";return a.register({name:"dnd",init:function(g){if(!g.dnd||this.request("predict-runtime-type")!=="html5"){return}var m=this,p=c.Deferred(),o=b.extend({},{disableGlobalDnd:g.disableGlobalDnd,container:g.dnd,accept:g.accept}),n;this.dnd=n=new h(o);n.once("ready",p.resolve);n.on("drop",function(i){m.request("add-file",[i])});n.on("accept",function(i){return m.owner.trigger("dndAccept",i)});n.init();return p.promise()},destroy:function(){this.dnd&&this.dnd.destroy()}})});f("lib/filepaste",["base","mediator","runtime/client"],function(c,a,i){var b=c.$;function j(g){g=this.options=b.extend({},g);g.container=b(g.container||document.body);i.call(this,"FilePaste")}c.inherits(i,{constructor:j,init:function(){var g=this;g.connectRuntime(g.options,function(){g.exec("init");g.trigger("ready")})}});a.installTo(j.prototype);return j});f("widgets/filepaste",["base","uploader","lib/filepaste","widgets/widget"],function(c,a,h){var b=c.$;return a.register({name:"paste",init:function(m){if(!m.paste||this.request("predict-runtime-type")!=="html5"){return}var n=this,p=c.Deferred(),o=b.extend({},{container:m.paste,accept:m.accept}),g;this.paste=g=new h(o);g.once("ready",p.resolve);g.on("paste",function(i){n.owner.request("add-file",[i])});g.init();return p.promise()},destroy:function(){this.paste&&this.paste.destroy()}})});f("lib/blob",["base","runtime/client"],function(b,c){function a(l,j){var k=this;k.source=j;k.ruid=l;this.size=j.size||0;if(!j.type&&this.ext&&~"jpg,jpeg,png,gif,bmp".indexOf(this.ext)){this.type="image/"+(this.ext==="jpg"?"jpeg":this.ext)}else{this.type=j.type||"application/octet-stream"}c.call(k,"Blob");this.uid=j.uid||this.uid;if(l){k.connectRuntime(l)}}b.inherits(c,{constructor:a,slice:function(i,j){return this.exec("slice",i,j)},getSource:function(){return this.source}});return a});f("lib/file",["base","lib/blob"],function(b,a){var c=1,j=/\.([^.]+)$/;function i(l,h){var g;this.name=h.name||("untitled"+c++);g=j.exec(h.name)?RegExp.$1.toLowerCase():"";if(!g&&h.type){g=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(h.type)?RegExp.$1.toLowerCase():"";this.name+="."+g}this.ext=g;this.lastModifiedDate=h.lastModifiedDate||(new Date()).toLocaleString();a.apply(this,arguments)}return b.inherits(a,i)});f("lib/filepicker",["base","runtime/client","lib/file"],function(b,c,i){var a=b.$;function j(g){g=this.options=a.extend({},j.options,g);g.container=a(g.id);if(!g.container.length){throw new Error("按钮指定错误")}g.innerHTML=g.innerHTML||g.label||g.container.html()||"";g.button=a(g.button||document.createElement("div"));g.button.html(g.innerHTML);g.container.html(g.button);c.call(this,"FilePicker",true)}j.options={button:null,container:null,label:null,innerHTML:null,multiple:true,accept:null,name:"file"};b.inherits(c,{constructor:j,init:function(){var g=this,h=g.options,l=h.button;l.addClass("webuploader-pick");g.on("all",function(n){var k;switch(n){case"mouseenter":l.addClass("webuploader-pick-hover");break;case"mouseleave":l.removeClass("webuploader-pick-hover");break;case"change":k=g.exec("getFiles");g.trigger("select",a.map(k,function(m){m=new i(g.getRuid(),m);m._refer=h.container;return m}),h.container);break}});g.connectRuntime(h,function(){g.refresh();g.exec("init",h);g.trigger("ready")});this._resizeHandler=b.bindFn(this.refresh,this);a(d).on("resize",this._resizeHandler)},refresh:function(){var o=this.getRuntime().getContainer(),n=this.options.button,h=n.outerWidth?n.outerWidth():n.width(),p=n.outerHeight?n.outerHeight():n.height(),g=n.offset();h&&p&&o.css({bottom:"auto",right:"auto",width:h+"px",height:p+"px"}).offset(g)},enable:function(){var g=this.options.button;g.removeClass("webuploader-pick-disable");this.refresh()},disable:function(){var g=this.options.button;this.getRuntime().getContainer().css({top:"-99999px"});g.addClass("webuploader-pick-disable")},destroy:function(){var g=this.options.button;a(d).off("resize",this._resizeHandler);g.removeClass("webuploader-pick-disable webuploader-pick-hover webuploader-pick")}});return j});f("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(c,a,h){var b=c.$;b.extend(a.options,{pick:null,accept:null});return a.register({name:"picker",init:function(g){this.pickers=[];return g.pick&&this.addBtn(g.pick)},refresh:function(){b.each(this.pickers,function(){this.refresh()})},addBtn:function(n){var g=this,m=g.options,o=m.accept,p=[];if(!n){return}b.isPlainObject(n)||(n={id:n});b(n.id).each(function(){var j,k,i;i=c.Deferred();j=b.extend({},n,{accept:b.isPlainObject(o)?[o]:o,swf:m.swf,runtimeOrder:m.runtimeOrder,id:this});k=new h(j);k.once("ready",i.resolve);k.on("select",function(l){g.owner.request("add-file",[l])});k.init();g.pickers.push(k);p.push(i.promise())});return c.when.apply(c,p)},disable:function(){b.each(this.pickers,function(){this.disable()})},enable:function(){b.each(this.pickers,function(){this.enable()})},destroy:function(){b.each(this.pickers,function(){this.destroy()});this.pickers=null}})});f("lib/image",["base","runtime/client","lib/blob"],function(c,i,a){var b=c.$;function j(g){this.options=b.extend({},j.options,g);i.call(this,"Image");this.on("load",function(){this._info=this.exec("info");this._meta=this.exec("meta")})}j.options={quality:90,crop:false,preserveHeaders:false,allowMagnify:false};c.inherits(i,{constructor:j,info:function(g){if(g){this._info=g;return this}return this._info},meta:function(g){if(g){this._meta=g;return this}return this._meta},loadFromBlob:function(l){var g=this,h=l.getRuid();this.connectRuntime(h,function(){g.exec("init",g.options);g.exec("loadFromBlob",l)})},resize:function(){var g=c.slice(arguments);return this.exec.apply(this,["resize"].concat(g))},crop:function(){var g=c.slice(arguments);return this.exec.apply(this,["crop"].concat(g))},getAsDataUrl:function(g){return this.exec("getAsDataUrl",g)},getAsBlob:function(g){var h=this.exec("getAsBlob",g);return new a(this.getRuid(),h)}});return j});f("widgets/image",["base","uploader","lib/image","widgets/widget"],function(i,a,j){var b=i.$,c;c=(function(n){var m=0,g=[],h=function(){var k;while(g.length&&m<n){k=g.shift();m+=k[0];k[1]()}};return function(l,p,k){g.push([p,k]);l.once("destroy",function(){m-=p;setTimeout(h,1)});setTimeout(h,1)}})(5*1024*1024);b.extend(a.options,{thumb:{width:110,height:110,quality:70,allowMagnify:true,crop:true,preserveHeaders:false,type:"image/jpeg"},compress:{width:1600,height:1600,quality:90,allowMagnify:false,crop:false,preserveHeaders:true}});return a.register({name:"image",makeThumb:function(o,p,h,q){var g,r;o=this.request("get-file",o);if(!o.type.match(/^image/)){p(true);return}g=b.extend({},this.options.thumb);if(b.isPlainObject(h)){g=b.extend(g,h);h=null}h=h||g.width;q=q||g.height;r=new j(g);r.once("load",function(){o._info=o._info||r.info();o._meta=o._meta||r.meta();if(h<=1&&h>0){h=o._info.width*h}if(q<=1&&q>0){q=o._info.height*q}r.resize(h,q)});r.once("complete",function(){p(false,r.getAsDataUrl(g.type));r.destroy()});r.once("error",function(k){p(k||true);r.destroy()});c(r,o.source.size,function(){o._info&&r.info(o._info);o._meta&&r.meta(o._meta);r.loadFromBlob(o.source)})},beforeSendFile:function(o){var g=this.options.compress||this.options.resize,p=g&&g.compressSize||0,h=g&&g.noCompressIfLarger||false,r,q;o=this.request("get-file",o);if(!g||!~"image/jpeg,image/jpg".indexOf(o.type)||o.size<p||o._compressed){return}g=b.extend({},g);q=i.Deferred();r=new j(g);q.always(function(){r.destroy();r=null});r.once("error",q.reject);r.once("load",function(){var k=g.width,l=g.height;o._info=o._info||r.info();o._meta=o._meta||r.meta();if(k<=1&&k>0){k=o._info.width*k}if(l<=1&&l>0){l=o._info.height*l}r.resize(k,l)});r.once("complete",function(){var m,l;try{m=r.getAsBlob(g.type);l=o.size;if(!h||m.size<l){o.source=m;o.size=m.size;o.trigger("resize",m.size,l)}o._compressed=true;q.resolve()}catch(k){q.resolve()}});o._info&&r.info(o._info);o._meta&&r.meta(o._meta);r.loadFromBlob(o.source);return q.promise()}})});f("file",["base","mediator"],function(n,b){var p=n.$,r="WU_FILE_",o=0,m=/\.([^.]+)$/,q={};function c(){return r+o++}function a(g){this.name=g.name||"Untitled";this.size=g.size||0;this.type=g.type||"application/octet-stream";this.lastModifiedDate=g.lastModifiedDate||(new Date()*1);this.id=c();this.ext=m.exec(this.name)?RegExp.$1:"";this.statusText="";q[this.id]=a.Status.INITED;this.source=g;this.loaded=0;this.on("error",function(h){this.setStatus(a.Status.ERROR,h)})}p.extend(a.prototype,{setStatus:function(i,h){var g=q[this.id];typeof h!=="undefined"&&(this.statusText=h);if(i!==g){q[this.id]=i;this.trigger("statuschange",i,g)}},getStatus:function(){return q[this.id]},getSource:function(){return this.source},destroy:function(){this.off();delete q[this.id]}});b.installTo(a.prototype);a.Status={INITED:"inited",QUEUED:"queued",PROGRESS:"progress",ERROR:"error",COMPLETE:"complete",CANCELLED:"cancelled",INTERRUPT:"interrupt",INVALID:"invalid"};return a});f("queue",["base","mediator","file"],function(k,a,b){var c=k.$,l=b.Status;function j(){this.stats={numOfQueue:0,numOfSuccess:0,numOfCancel:0,numOfProgress:0,numOfUploadFailed:0,numOfInvalid:0,numofDeleted:0,numofInterrupt:0};this._queue=[];this._map={}}c.extend(j.prototype,{append:function(g){this._queue.push(g);this._fileAdded(g);return this},prepend:function(g){this._queue.unshift(g);this._fileAdded(g);return this},getFile:function(g){if(typeof g!=="string"){return g}return this._map[g]},fetch:function(i){var n=this._queue.length,g,h;i=i||l.QUEUED;for(g=0;g<n;g++){h=this._queue[g];if(i===h.getStatus()){return h}}return null},sort:function(g){if(typeof g==="function"){this._queue.sort(g)}},getFiles:function(){var p=[].slice.call(arguments,0),i=[],g=0,o=this._queue.length,h;for(;g<o;g++){h=this._queue[g];if(p.length&&!~c.inArray(h.getStatus(),p)){continue}i.push(h)}return i},removeFile:function(i){var g=this,h=this._map[i.id];if(h){delete this._map[i.id];i.destroy();this.stats.numofDeleted++}},_fileAdded:function(i){var g=this,h=this._map[i.id];if(!h){this._map[i.id]=i;i.on("statuschange",function(p,o){g._onFileStatusChange(p,o)})}},_onFileStatusChange:function(i,h){var g=this.stats;switch(h){case l.PROGRESS:g.numOfProgress--;break;case l.QUEUED:g.numOfQueue--;break;case l.ERROR:g.numOfUploadFailed--;break;case l.INVALID:g.numOfInvalid--;break;case l.INTERRUPT:g.numofInterrupt--;break}switch(i){case l.QUEUED:g.numOfQueue++;break;case l.PROGRESS:g.numOfProgress++;break;case l.ERROR:g.numOfUploadFailed++;break;case l.COMPLETE:g.numOfSuccess++;break;case l.CANCELLED:g.numOfCancel++;break;case l.INVALID:g.numOfInvalid++;break;case l.INTERRUPT:g.numofInterrupt++;break}}});a.installTo(j.prototype);return j});f("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(o,r,q,a,m,b){var p=o.$,n=/\.\w+$/,c=a.Status;return r.register({name:"queue",init:function(l){var x=this,v,g,i,w,h,k,j;if(p.isPlainObject(l.accept)){l.accept=[l.accept]}if(l.accept){h=[];for(i=0,g=l.accept.length;i<g;i++){w=l.accept[i].extensions;w&&h.push(w)}if(h.length){k="\\."+h.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"}x.accept=new RegExp(k,"i")}x.queue=new q();x.stats=x.queue.stats;if(this.request("predict-runtime-type")!=="html5"){return}v=o.Deferred();this.placeholder=j=new b("Placeholder");j.connectRuntime({runtimeOrder:"html5"},function(){x._ruid=j.getRuid();v.resolve()});return v.promise()},_wrapFile:function(g){if(!(g instanceof a)){if(!(g instanceof m)){if(!this._ruid){throw new Error("Can't add external files.")}g=new m(this._ruid,g)}g=new a(g)}return g},acceptFile:function(g){var h=!g||!g.size||this.accept&&n.exec(g.name)&&!this.accept.test(g.name);return !h},_addFile:function(g){var h=this;g=h._wrapFile(g);if(!h.owner.trigger("beforeFileQueued",g)){return}if(!h.acceptFile(g)){h.owner.trigger("error","Q_TYPE_DENIED",g);return}h.queue.append(g);h.owner.trigger("fileQueued",g);return g},getFile:function(g){return this.queue.getFile(g)},addFile:function(h){var g=this;if(!h.length){h=[h]}h=p.map(h,function(i){return g._addFile(i)});g.owner.trigger("filesQueued",h);if(g.options.auto){setTimeout(function(){g.request("start-upload")},20)}},getStats:function(){return this.stats},removeFile:function(i,g){var h=this;i=i.id?i:h.queue.getFile(i);this.request("cancel-file",i);if(g){this.queue.removeFile(i)}},getFiles:function(){return this.queue.getFiles.apply(this.queue,arguments)},fetchFile:function(){return this.queue.fetch.apply(this.queue,arguments)},retry:function(j,l){var h=this,i,k,g;if(j){j=j.id?j:h.queue.getFile(j);j.setStatus(c.QUEUED);l||h.request("start-upload");return}i=h.queue.getFiles(c.ERROR);k=0;g=i.length;for(;k<g;k++){j=i[k];j.setStatus(c.QUEUED)}h.request("start-upload")},sortFiles:function(){return this.queue.sort.apply(this.queue,arguments)},reset:function(){this.owner.trigger("reset");this.queue=new q();this.stats=this.queue.stats},destroy:function(){this.reset();this.placeholder&&this.placeholder.destroy()}})});f("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(a,b){a.support=function(){return b.hasRuntime.apply(b,arguments)};return a.register({name:"runtime",init:function(){if(!this.predictRuntimeType()){throw Error("Runtime Error")}},predictRuntimeType:function(){var c=this.options.runtimeOrder||b.orders,i=this.type,k,l;if(!i){c=c.split(/\s*,\s*/g);for(k=0,l=c.length;k<l;k++){if(b.hasRuntime(c[k])){this.type=i=c[k];break}}}return i}})});f("lib/transport",["base","runtime/client","mediator"],function(i,j,b){var c=i.$;function a(g){var h=this;g=h.options=c.extend(true,{},a.options,g||{});j.call(this,"Transport");this._blob=null;this._formData=g.formData||{};this._headers=g.headers||{};this.on("progress",this._timeout);this.on("load error",function(){h.trigger("progress",1);clearTimeout(h._timer)})}a.options={server:"",method:"POST",withCredentials:false,fileVal:"file",timeout:2*60*1000,formData:{},headers:{},sendAsBinary:false};c.extend(a.prototype,{appendBlob:function(n,o,p){var g=this,h=g.options;if(g.getRuid()){g.disconnectRuntime()}g.connectRuntime(o.ruid,function(){g.exec("init")});g._blob=o;h.fileVal=n||h.fileVal;h.filename=p||h.filename},append:function(h,g){if(typeof h==="object"){c.extend(this._formData,h)}else{this._formData[h]=g}},setRequestHeader:function(h,g){if(typeof h==="object"){c.extend(this._headers,h)}else{this._headers[h]=g}},send:function(g){this.exec("send",g);this._timeout()},abort:function(){clearTimeout(this._timer);return this.exec("abort")},destroy:function(){this.trigger("destroy");this.off();this.exec("destroy");this.disconnectRuntime()},getResponse:function(){return this.exec("getResponse")},getResponseAsJson:function(){return this.exec("getResponseAsJson")},getStatus:function(){return this.exec("getStatus")},_timeout:function(){var h=this,g=h.options.timeout;if(!g){return}clearTimeout(h._timer);h._timer=setTimeout(function(){h.abort();h.trigger("error","timeout")},g)}});b.installTo(a.prototype);return a});f("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(n,b,c,a){var l=n.$,o=n.isPromise,p=c.Status;l.extend(b.options,{prepareNextFile:false,chunked:false,chunkSize:5*1024*1024,chunkRetry:2,threads:3,formData:{}});function m(j,i){var k=[],w=j.source,x=w.size,h=i?Math.ceil(x/i):1,v=0,y=0,z,g;g={file:j,has:function(){return !!k.length},shift:function(){return k.shift()},unshift:function(q){k.unshift(q)}};while(y<h){z=Math.min(i,x-v);k.push({file:j,start:v,end:i?(v+z):x,total:x,chunks:h,chunk:y++,cuted:g});v+=z}j.blocks=k.concat();j.remaning=k.length;return g}b.register({name:"upload",init:function(){var h=this.owner,g=this;this.runing=false;this.progress=false;h.on("startUpload",function(){g.progress=true}).on("uploadFinished",function(){g.progress=false});this.pool=[];this.stack=[];this.pending=[];this.remaning=0;this.__tick=n.bindFn(this._tick,this);h.on("uploadComplete",function(i){i.blocks&&l.each(i.blocks,function(j,k){k.transport&&(k.transport.abort(),k.transport.destroy());delete k.transport});delete i.blocks;delete i.remaning})},reset:function(){this.request("stop-upload",true);this.runing=false;this.pool=[];this.stack=[];this.pending=[];this.remaning=0;this._trigged=false;this._promise=null},startUpload:function(h){var i=this;l.each(i.request("get-files",p.INVALID),function(){i.request("remove-file",this)});if(h){h=h.id?h:i.request("get-file",h);if(h.getStatus()===p.INTERRUPT){l.each(i.pool,function(j,k){if(k.file!==h){return}k.transport&&k.transport.send()});h.setStatus(p.QUEUED)}else{if(h.getStatus()===p.PROGRESS){return}else{h.setStatus(p.QUEUED)}}}else{l.each(i.request("get-files",[p.INITED]),function(){this.setStatus(p.QUEUED)})}if(i.runing){return}i.runing=true;var g=[];l.each(i.pool,function(k,r){var j=r.file;if(j.getStatus()===p.INTERRUPT){g.push(j);i._trigged=false;r.transport&&r.transport.send()}});var h;while((h=g.shift())){h.setStatus(p.PROGRESS)}h||l.each(i.request("get-files",p.INTERRUPT),function(){this.setStatus(p.PROGRESS)});i._trigged=false;n.nextTick(i.__tick);i.owner.trigger("startUpload")},stopUpload:function(h,i){var g=this;if(h===true){i=h;h=null}if(g.runing===false){return}if(h){h=h.id?h:g.request("get-file",h);if(h.getStatus()!==p.PROGRESS&&h.getStatus()!==p.QUEUED){return}h.setStatus(p.INTERRUPT);l.each(g.pool,function(j,k){if(k.file!==h){return}k.transport&&k.transport.abort();g._putback(k);g._popBlock(k)});return n.nextTick(g.__tick)}g.runing=false;if(this._promise&&this._promise.file){this._promise.file.setStatus(p.INTERRUPT)}i&&l.each(g.pool,function(j,k){k.transport&&k.transport.abort();k.file.setStatus(p.INTERRUPT)});g.owner.trigger("stopUpload")},cancelFile:function(g){g=g.id?g:this.request("get-file",g);g.blocks&&l.each(g.blocks,function(i,j){var h=j.transport;if(h){h.abort();h.destroy();delete j.transport}});g.setStatus(p.CANCELLED);this.owner.trigger("fileDequeued",g)},isInProgress:function(){return !!this.progress},_getStats:function(){return this.request("get-stats")},skipFile:function(g,h){g=g.id?g:this.request("get-file",g);g.setStatus(h||p.COMPLETE);g.skipped=true;g.blocks&&l.each(g.blocks,function(i,j){var k=j.transport;if(k){k.abort();k.destroy();delete j.transport}});this.owner.trigger("uploadSkip",g)},_tick:function(){var j=this,g=j.options,h,i;if(j._promise){return j._promise.always(j.__tick)}if(j.pool.length<g.threads&&(i=j._nextBlock())){j._trigged=false;h=function(k){j._promise=null;k&&k.file&&j._startSend(k);n.nextTick(j.__tick)};j._promise=o(i)?i.always(h):h(i)}else{if(!j.remaning&&!j._getStats().numOfQueue&&!j._getStats().numofInterrupt){j.runing=false;j._trigged||n.nextTick(function(){j.owner.trigger("uploadFinished")});j._trigged=true}}},_putback:function(g){var h;g.cuted.unshift(g);h=this.stack.indexOf(g.cuted);if(!~h){this.stack.unshift(g.cuted)}},_getStack:function(){var g=0,h;while((h=this.stack[g++])){if(h.has()&&h.file.getStatus()===p.PROGRESS){return h}else{if(!h.has()||h.file.getStatus()!==p.PROGRESS&&h.file.getStatus()!==p.INTERRUPT){this.stack.splice(--g,1)}}}return null},_nextBlock:function(){var i=this,j=i.options,g,k,h,r;if((g=this._getStack())){if(j.prepareNextFile&&!i.pending.length){i._prepareNextFile()}return g.shift()}else{if(i.runing){if(!i.pending.length&&i._getStats().numOfQueue){i._prepareNextFile()}k=i.pending.shift();h=function(q){if(!q){return null}g=m(q,j.chunked?j.chunkSize:0);i.stack.push(g);return g.shift()};if(o(k)){r=k.file;k=k[k.pipe?"pipe":"then"](h);k.file=r;return k}return h(k)}}},_prepareNextFile:function(){var g=this,h=g.request("fetch-file"),i=g.pending,j;if(h){j=g.request("before-send-file",h,function(){if(h.getStatus()===p.PROGRESS||h.getStatus()===p.INTERRUPT){return h}return g._finishFile(h)});g.owner.trigger("uploadStart",h);h.setStatus(p.PROGRESS);j.file=h;j.done(function(){var k=l.inArray(j,i);~k&&i.splice(k,1,h)});j.fail(function(k){h.setStatus(p.ERROR,k);g.owner.trigger("uploadError",h,k);g.owner.trigger("uploadComplete",h)});i.push(j)}},_popBlock:function(g){var h=l.inArray(g,this.pool);this.pool.splice(h,1);g.file.remaning--;this.remaning--},_startSend:function(i){var g=this,h=i.file,j;if(h.getStatus()!==p.PROGRESS){if(h.getStatus()===p.INTERRUPT){g._putback(i)}return}g.pool.push(i);g.remaning++;i.blob=i.chunks===1?h.source:h.source.slice(i.start,i.end);j=g.request("before-send",i,function(){if(h.getStatus()===p.PROGRESS){g._doSend(i)}else{g._popBlock(i);n.nextTick(g.__tick)}});j.fail(function(){if(h.remaning===1){g._finishFile(h).always(function(){i.percentage=1;g._popBlock(i);g.owner.trigger("uploadComplete",h);n.nextTick(g.__tick)})}else{i.percentage=1;g.updateFileProgress(h);g._popBlock(i);n.nextTick(g.__tick)}})},_doSend:function(i){var y=this,v=y.owner,w=y.options,j=i.file,z=new a(w),h=l.extend({},w.formData),k=l.extend({},w.headers),x,g;i.transport=z;z.on("destroy",function(){delete i.transport;y._popBlock(i);n.nextTick(y.__tick)});z.on("progress",function(q){i.percentage=q;y.updateFileProgress(j)});x=function(q){var r;g=z.getResponseAsJson()||{};g._raw=z.getResponse();r=function(s){q=s};if(!v.trigger("uploadAccept",i,g,r)){q=q||"server"}return q};z.on("error",function(q,r){i.retried=i.retried||0;if(i.chunks>1&&~"http,abort".indexOf(q)&&i.retried<w.chunkRetry){i.retried++;z.send()}else{if(!r&&q==="server"){q=x(q)}j.setStatus(p.ERROR,q);v.trigger("uploadError",j,q);v.trigger("uploadComplete",j)}});z.on("load",function(){var q;if((q=x())){z.trigger("error",q,true);return}if(j.remaning===1){y._finishFile(j,g)}else{z.destroy()}});h=l.extend(h,{id:j.id,name:j.name,type:j.type,lastModifiedDate:j.lastModifiedDate,size:j.size});i.chunks>1&&l.extend(h,{chunks:i.chunks,chunk:i.chunk});v.trigger("uploadBeforeSend",i,h,k);z.appendBlob(w.fileVal,i.blob,j.name);z.append(h);z.setRequestHeader(k);z.send()},_finishFile:function(j,g,i){var h=this.owner;return h.request("after-send-file",arguments,function(){j.setStatus(p.COMPLETE);h.trigger("uploadSuccess",j,g,i)}).fail(function(k){if(j.getStatus()===p.PROGRESS){j.setStatus(p.ERROR,k)}h.trigger("uploadError",j,k)}).always(function(){h.trigger("uploadComplete",j)})},updateFileProgress:function(i){var g=0,h=0;if(!i.blocks){return}l.each(i.blocks,function(j,k){h+=(k.percentage||0)*(k.end-k.start)});g=h/i.size;this.owner.trigger("uploadProgress",i,g||0)}})});f("widgets/validator",["base","uploader","file","widgets/widget"],function(k,a,b){var c=k.$,l={},j;j={addValidator:function(g,h){l[g]=h},removeValidator:function(g){delete l[g]}};a.register({name:"validator",init:function(){var g=this;k.nextTick(function(){c.each(l,function(){this.call(g.owner)})})}});j.addValidator("fileNumLimit",function(){var p=this,g=p.options,h=0,o=parseInt(g.fileNumLimit,10),i=true;if(!o){return}p.on("beforeFileQueued",function(m){if(h>=o&&i){i=false;this.trigger("error","Q_EXCEED_NUM_LIMIT",o,m);setTimeout(function(){i=true},1)}return h>=o?false:true});p.on("fileQueued",function(){h++});p.on("fileDequeued",function(){h--});p.on("reset",function(){h=0})});j.addValidator("fileSizeLimit",function(){var p=this,g=p.options,h=0,o=parseInt(g.fileSizeLimit,10),i=true;if(!o){return}p.on("beforeFileQueued",function(n){var m=h+n.size>o;if(m&&i){i=false;this.trigger("error","Q_EXCEED_SIZE_LIMIT",o,n);setTimeout(function(){i=true},1)}return m?false:true});p.on("fileQueued",function(m){h+=m.size});p.on("fileDequeued",function(m){h-=m.size});p.on("reset",function(){h=0})});j.addValidator("fileSingleSizeLimit",function(){var g=this,h=g.options,i=h.fileSingleSizeLimit;if(!i){return}g.on("beforeFileQueued",function(n){if(n.size>i){n.setStatus(b.Status.INVALID,"exceed_size");this.trigger("error","F_EXCEED_SIZE",i,n);return false}})});j.addValidator("duplicate",function(){var g=this,i=g.options,n={};if(i.duplicate){return}function h(m){var s=0,t=0,v=m.length,u;for(;t<v;t++){u=m.charCodeAt(t);s=u+(s<<6)+(s<<16)-s}return s}g.on("beforeFileQueued",function(p){var m=p.__hash||(p.__hash=h(p.name+p.size+p.lastModifiedDate));if(n[m]){this.trigger("error","F_DUPLICATE",p);return false}});g.on("fileQueued",function(p){var m=p.__hash;m&&(n[m]=true)});g.on("fileDequeued",function(p){var m=p.__hash;m&&(delete n[m])});g.on("reset",function(){n={}})});return j});f("lib/md5",["runtime/client","mediator"],function(b,a){function c(){b.call(this,"Md5")}a.installTo(c.prototype);c.prototype.loadFromBlob=function(j){var i=this;if(i.getRuid()){i.disconnectRuntime()}i.connectRuntime(j.ruid,function(){i.exec("init");i.exec("loadFromBlob",j)})};c.prototype.getResult=function(){return this.exec("getResult")};return c});f("widgets/md5",["base","uploader","lib/md5","lib/blob","widgets/widget"],function(c,b,h,a){return b.register({name:"md5",md5File:function(o,g,r){var n=new h(),p=c.Deferred(),q=(o instanceof a)?o:this.request("get-file",o).source;n.on("progress load",function(i){i=i||{};p.notify(i.total?i.loaded/i.total:1)});n.on("complete",function(){p.resolve(n.getResult())});n.on("error",function(i){p.reject(i)});if(arguments.length>1){g=g||0;r=r||0;g<0&&(g=q.size+g);r<0&&(r=q.size+r);r=Math.min(r,q.size);q=q.slice(g,r)}n.loadFromBlob(q);return p.promise()}})});f("runtime/compbase",[],function(){function a(c,b){this.owner=c;this.options=c.options;this.getRuntime=function(){return b};this.getRuid=function(){return b.uid};this.trigger=function(){return c.trigger.apply(c,arguments)}}return a});f("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(k,l,a){var j="html5",c={};function b(){var h={},g=this,i=this.destroy;l.apply(g,arguments);g.type=j;g.exec=function(w,t){var x=this,u=x.uid,v=k.slice(arguments,2),s;if(c[w]){s=h[u]=h[u]||new c[w](x,g);if(s[t]){return s[t].apply(s,v)}}};g.destroy=function(){return i&&i.apply(this,arguments)}}k.inherits(l,{constructor:b,init:function(){var g=this;setTimeout(function(){g.trigger("ready")},1)}});b.register=function(g,h){var i=c[g]=k.inherits(a,h);return i};if(d.Blob&&d.FileReader&&d.DataView){l.addRuntime(j,b)}return b});f("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(a,b){return a.register("Blob",{slice:function(c,l){var k=this.owner.source,j=k.slice||k.webkitSlice||k.mozSlice;k=j.call(k,c,l);return new b(this.getRuid(),k)}})});f("runtime/html5/dnd",["base","runtime/html5/runtime","lib/file"],function(i,a,j){var b=i.$,c="webuploader-dnd-";return a.register("DragAndDrop",{init:function(){var g=this.elem=this.options.container;this.dragEnterHandler=i.bindFn(this._dragEnterHandler,this);this.dragOverHandler=i.bindFn(this._dragOverHandler,this);this.dragLeaveHandler=i.bindFn(this._dragLeaveHandler,this);this.dropHandler=i.bindFn(this._dropHandler,this);this.dndOver=false;g.on("dragenter",this.dragEnterHandler);g.on("dragover",this.dragOverHandler);g.on("dragleave",this.dragLeaveHandler);g.on("drop",this.dropHandler);if(this.options.disableGlobalDnd){b(document).on("dragover",this.dragOverHandler);b(document).on("drop",this.dropHandler)}},_dragEnterHandler:function(g){var h=this,m=h._denied||false,n;g=g.originalEvent||g;if(!h.dndOver){h.dndOver=true;n=g.dataTransfer.items;if(n&&n.length){h._denied=m=!h.trigger("accept",n)}h.elem.addClass(c+"over");h.elem[m?"addClass":"removeClass"](c+"denied")}g.dataTransfer.dropEffect=m?"none":"copy";return false},_dragOverHandler:function(g){var h=this.elem.parent().get(0);if(h&&!b.contains(h,g.currentTarget)){return false}clearTimeout(this._leaveTimer);this._dragEnterHandler.call(this,g);return false},_dragLeaveHandler:function(){var g=this,h;h=function(){g.dndOver=false;g.elem.removeClass(c+"over "+c+"denied")};clearTimeout(g._leaveTimer);g._leaveTimer=setTimeout(h,100);return false},_dropHandler:function(s){var h=this,q=h.getRuid(),r=h.elem.parent().get(0),t,g;if(r&&!b.contains(r,s.currentTarget)){return false}s=s.originalEvent||s;t=s.dataTransfer;try{g=t.getData("text/html")}catch(p){}if(g){return}h._getTansferFiles(t,function(k){h.trigger("drop",b.map(k,function(l){return new j(q,l)}))});h.dndOver=false;h.elem.removeClass(c+"over");return false},_getTansferFiles:function(h,g){var x=[],u=[],v,A,z,C,y,w,B;v=h.items;A=h.files;B=!!(v&&v[0].webkitGetAsEntry);for(y=0,w=A.length;y<w;y++){z=A[y];C=v&&v[y];if(B&&C.webkitGetAsEntry().isDirectory){u.push(this._traverseDirectoryTree(C.webkitGetAsEntry(),x))}else{x.push(z)}}i.when.apply(i,u).done(function(){if(!x.length){return}g(x)})},_traverseDirectoryTree:function(g,m){var n=i.Deferred(),h=this;if(g.isFile){g.file(function(k){m.push(k);n.resolve()})}else{if(g.isDirectory){g.createReader().readEntries(function(s){var t=s.length,l=[],k=[],r;for(r=0;r<t;r++){l.push(h._traverseDirectoryTree(s[r],k))}i.when.apply(i,l).then(function(){m.push.apply(m,k);n.resolve()},n.reject)})}}return n.promise()},destroy:function(){var g=this.elem;if(!g){return}g.off("dragenter",this.dragEnterHandler);g.off("dragover",this.dragOverHandler);g.off("dragleave",this.dragLeaveHandler);g.off("drop",this.dropHandler);if(this.options.disableGlobalDnd){b(document).off("dragover",this.dragOverHandler);b(document).off("drop",this.dropHandler)}}})});f("runtime/html5/filepaste",["base","runtime/html5/runtime","lib/file"],function(b,a,c){return a.register("FilePaste",{init:function(){var t=this.options,i=this.elem=t.container,p=".*",r,q,s,o;if(t.accept){r=[];for(q=0,s=t.accept.length;q<s;q++){o=t.accept[q].mimeTypes;o&&r.push(o)}if(r.length){p=r.join(",");p=p.replace(/,/g,"|").replace(/\*/g,".*")}}this.accept=p=new RegExp(p,"i");this.hander=b.bindFn(this._pasteHander,this);i.on("paste",this.hander)},_pasteHander:function(v){var u=[],q=this.getRuid(),r,i,s,p,t;v=v.originalEvent||v;r=v.clipboardData.items;for(p=0,t=r.length;p<t;p++){i=r[p];if(i.kind!=="file"||!(s=i.getAsFile())){continue}u.push(new c(q,s))}if(u.length){v.preventDefault();v.stopPropagation();this.trigger("paste",u)}},destroy:function(){this.elem.off("paste",this.hander)}})});f("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(c,a){var b=c.$;return a.register("FilePicker",{init:function(){var y=this.getRuntime().getContainer(),t=this,x=t.owner,z=t.options,r=this.label=b(document.createElement("label")),i=this.input=b(document.createElement("input")),v,w,u,s;i.attr("type","file");i.attr("name",z.name);i.addClass("webuploader-element-invisible");r.on("click",function(){i.trigger("click")});r.css({opacity:0,width:"100%",height:"100%",display:"block",cursor:"pointer",background:"#ffffff"});if(z.multiple){i.attr("multiple","multiple")}if(z.accept&&z.accept.length>0){v=[];for(w=0,u=z.accept.length;w<u;w++){v.push(z.accept[w].mimeTypes)}i.attr("accept",v.join(","))}y.append(i);y.append(r);s=function(g){x.trigger(g.type)};i.on("change",function(j){var g=arguments.callee,h;t.files=j.target.files;h=this.cloneNode(true);h.value=null;this.parentNode.replaceChild(h,this);i.off();i=b(h).on("change",g).on("mouseenter mouseleave",s);x.trigger("change")});r.on("mouseenter mouseleave",s)},getFiles:function(){return this.files},destroy:function(){this.input.off();this.label.off()}})});f("runtime/html5/util",["base"],function(c){var b=d.createObjectURL&&d||d.URL&&URL.revokeObjectURL&&URL||d.webkitURL,a=c.noop,h=a;if(b){a=function(){return b.createObjectURL.apply(b,arguments)};h=function(){return b.revokeObjectURL.apply(b,arguments)}}return{createObjectURL:a,revokeObjectURL:h,dataURL2Blob:function(q){var g,s,i,p,r,t;t=q.split(",");if(~t[0].indexOf("base64")){g=atob(t[1])}else{g=decodeURIComponent(t[1])}i=new ArrayBuffer(g.length);s=new Uint8Array(i);for(p=0;p<g.length;p++){s[p]=g.charCodeAt(p)}r=t[0].split(":")[1].split(";")[0];return this.arrayBufferToBlob(i,r)},dataURL2ArrayBuffer:function(p){var n,g,o,i;i=p.split(",");if(~i[0].indexOf("base64")){n=atob(i[1])}else{n=decodeURIComponent(i[1])}g=new Uint8Array(n.length);for(o=0;o<n.length;o++){g[o]=n.charCodeAt(o)}return g.buffer},arrayBufferToBlob:function(n,l){var m=d.BlobBuilder||d.WebKitBlobBuilder,g;if(m){g=new m();g.append(n);return g.getBlob(l)}return new Blob([n],l?{type:l}:{})},canvasToDataUrl:function(l,k,g){return l.toDataURL(k,g/100)},parseMeta:function(j,g){g(false,{})},updateImageHead:function(g){return g}}});f("runtime/html5/imagemeta",["runtime/html5/util"],function(a){var b;b={parsers:{65505:[]},maxMetaDataSize:262144,parse:function(j,l){var c=this,k=new FileReader();k.onload=function(){l(false,c._parse(this.result));k=k.onload=k.onerror=null};k.onerror=function(g){l(g.message);k=k.onload=k.onerror=null};j=j.slice(0,c.maxMetaDataSize);k.readAsArrayBuffer(j.getSource())},_parse:function(v,i){if(v.byteLength<6){return}var t=new DataView(v),w=2,y=t.byteLength-4,s=w,r={},z,x,c,u;if(t.getUint16(0)===65496){while(w<y){z=t.getUint16(w);if(z>=65504&&z<=65519||z===65534){x=t.getUint16(w+2)+2;if(w+x>t.byteLength){break}c=b.parsers[z];if(!i&&c){for(u=0;u<c.length;u+=1){c[u].call(b,t,w,x,r)}}w+=x;s=w}else{break}}if(s>6){if(v.slice){r.imageHead=v.slice(2,s)}else{r.imageHead=new Uint8Array(v).subarray(2,s)}}}return r},updateImageHead:function(p,o){var m=this._parse(p,true),l,n,c;c=2;if(m.imageHead){c=2+m.imageHead.byteLength}if(p.slice){n=p.slice(c)}else{n=new Uint8Array(p).subarray(c)}l=new Uint8Array(o.byteLength+2+n.byteLength);l[0]=255;l[1]=216;l.set(new Uint8Array(o),2);l.set(new Uint8Array(n),o.byteLength+2);return l.buffer}};a.parseMeta=function(){return b.parse.apply(b,arguments)};a.updateImageHead=function(){return b.updateImageHead.apply(b,arguments)};return b});f("runtime/html5/imagemeta/exif",["base","runtime/html5/imagemeta"],function(a,b){var c={};c.ExifMap=function(){return this};c.ExifMap.prototype.map={Orientation:274};c.ExifMap.prototype.get=function(h){return this[h]||this[this.map[h]]};c.exifTagTypes={1:{getValue:function(i,j){return i.getUint8(j)},size:1},2:{getValue:function(i,j){return String.fromCharCode(i.getUint8(j))},size:1,ascii:true},3:{getValue:function(j,l,k){return j.getUint16(l,k)},size:2},4:{getValue:function(j,l,k){return j.getUint32(l,k)},size:4},5:{getValue:function(j,l,k){return j.getUint32(l,k)/j.getUint32(l+4,k)},size:8},9:{getValue:function(j,l,k){return j.getInt32(l,k)},size:4},10:{getValue:function(j,l,k){return j.getInt32(l,k)/j.getInt32(l+4,k)},size:8}};c.exifTagTypes[7]=c.exifTagTypes[1];c.getExifValue=function(i,u,z,v,B,D){var F=c.exifTagTypes[v],C,A,E,y,w,x;if(!F){a.log("Invalid Exif data: Invalid tag type.");return}C=F.size*B;A=C>4?u+i.getUint32(z+8,D):(z+8);if(A+C>i.byteLength){a.log("Invalid Exif data: Invalid data offset.");return}if(B===1){return F.getValue(i,A,D)}E=[];for(y=0;y<B;y+=1){E[y]=F.getValue(i,A+y*F.size,D)}if(F.ascii){w="";for(y=0;y<E.length;y+=1){x=E[y];if(x==="\u0000"){break}w+=x}return w}return E};c.parseExifTag=function(m,q,n,o,p){var r=m.getUint16(n,o);p.exif[r]=c.getExifValue(m,q,n,m.getUint16(n+2,o),m.getUint32(n+4,o),o)};c.parseExifTags=function(v,q,s,i,p){var u,t,r;if(s+6>v.byteLength){a.log("Invalid Exif data: Invalid directory offset.");return}u=v.getUint16(s,i);t=s+2+12*u;if(t+4>v.byteLength){a.log("Invalid Exif data: Invalid directory size.");return}for(r=0;r<u;r+=1){this.parseExifTag(v,q,s+2+12*r,i,p)}return v.getUint32(t,i)};c.parseExifData=function(n,o,r,q){var s=o+10,p,t;if(n.getUint32(o+4)!==1165519206){return}if(s+8>n.byteLength){a.log("Invalid Exif data: Invalid segment size.");return}if(n.getUint16(o+8)!==0){a.log("Invalid Exif data: Missing byte alignment offset.");return}switch(n.getUint16(s)){case 18761:p=true;break;case 19789:p=false;break;default:a.log("Invalid Exif data: Invalid byte alignment marker.");return}if(n.getUint16(s+2,p)!==42){a.log("Invalid Exif data: Missing TIFF marker.");return}t=n.getUint32(s+4,p);q.exif=new c.ExifMap();t=c.parseExifTags(n,s,s+t,p,q)};b.parsers[65505].push(c.parseExifData);return c});f("runtime/html5/jpegencoder",[],function(c,h,b){function a(aW){var aU=this;var ax=Math.round;var ao=Math.floor;var a0=new Array(64);var ap=new Array(64);var ai=new Array(64);var aG=new Array(64);var az;var aZ;var aQ;var aN;var aq=new Array(65535);var aV=new Array(65535);var ak=new Array(64);var ah=new Array(64);var aY=[];var ay=0;var a6=7;var aw=new Array(64);var a3=new Array(64);var aM=new Array(64);var a2=new Array(256);var av=new Array(2048);var aA;var al=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63];var a1=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];var a5=[0,1,2,3,4,5,6,7,8,9,10,11];var aC=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125];var aO=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250];var aE=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];var aD=[0,1,2,3,4,5,6,7,8,9,10,11];var aT=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119];var aK=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function an(m){var n=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(var o=0;o<64;o++){var j=ao((n[o]*m+50)/100);if(j<1){j=1}else{if(j>255){j=255}}a0[al[o]]=j}var l=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(var p=0;p<64;p++){var k=ao((l[p]*m+50)/100);if(k<1){k=1}else{if(k>255){k=255}}ap[al[p]]=k}var q=[1,1.387039845,1.306562965,1.175875602,1,0.785694958,0.5411961,0.275899379];var r=0;for(var i=0;i<8;i++){for(var s=0;s<8;s++){ai[r]=(1/(a0[al[r]]*q[i]*q[s]*8));aG[r]=(1/(ap[al[r]]*q[i]*q[s]*8));r++}}}function ar(m,l){var n=0;var k=0;var o=new Array();for(var j=1;j<=16;j++){for(var i=1;i<=m[j];i++){o[l[k]]=[];o[l[k]][0]=n;o[l[k]][1]=j;k++;n++}n*=2}return o}function aI(){az=ar(a1,a5);aZ=ar(aE,aD);aQ=ar(aC,aO);aN=ar(aT,aK)}function aH(){var i=1;var l=2;for(var j=1;j<=15;j++){for(var m=i;m<l;m++){aV[32767+m]=j;aq[32767+m]=[];aq[32767+m][1]=j;aq[32767+m][0]=m}for(var k=-(l-1);k<=-i;k++){aV[32767+k]=j;aq[32767+k]=[];aq[32767+k][1]=j;aq[32767+k][0]=l-1+k}i<<=1;l<<=1}}function aJ(){for(var i=0;i<256;i++){av[i]=19595*i;av[(i+256)>>0]=38470*i;av[(i+512)>>0]=7471*i+32768;av[(i+768)>>0]=-11059*i;av[(i+1024)>>0]=-21709*i;av[(i+1280)>>0]=32768*i+8421375;av[(i+1536)>>0]=-27439*i;av[(i+1792)>>0]=-5329*i}}function aB(i){var k=i[0];var j=i[1]-1;while(j>=0){if(k&(1<<j)){ay|=(1<<a6)}j--;a6--;if(a6<0){if(ay==255){aP(255);aP(0)}else{aP(ay)}a6=7;ay=0}}}function aP(i){aY.push(a2[i])}function at(i){aP((i>>8)&255);aP((i)&255)}function am(ad,X){var G,H,I,J,K,M,N,P;var D=0;var B;var Y=8;var m=64;for(B=0;B<Y;++B){G=ad[D];H=ad[D+1];I=ad[D+2];J=ad[D+3];K=ad[D+4];M=ad[D+5];N=ad[D+6];P=ad[D+7];var ac=G+P;var E=G-P;var ae=H+N;var C=H-N;var af=I+M;var A=I-M;var ag=J+K;var ba=J-K;var i=ac+ag;var l=ac-ag;var j=ae+af;var k=ae-af;ad[D]=i+j;ad[D+4]=i-j;var S=(k+l)*0.707106781;ad[D+2]=l+S;ad[D+6]=l-S;i=ba+A;j=A+C;k=C+E;var W=(i-k)*0.382683433;var T=0.5411961*i+W;var V=1.306562965*k+W;var U=j*0.707106781;var p=E+U;var q=E-U;ad[D+5]=q+T;ad[D+3]=q-T;ad[D+1]=p+V;ad[D+7]=p-V;D+=8}D=0;for(B=0;B<Y;++B){G=ad[D];H=ad[D+8];I=ad[D+16];J=ad[D+24];K=ad[D+32];M=ad[D+40];N=ad[D+48];P=ad[D+56];var n=G+P;var Z=G-P;var s=H+N;var R=H-N;var v=I+M;var O=I-M;var y=J+K;var a9=J-K;var o=n+y;var z=n-y;var t=s+v;var w=s-v;ad[D]=o+t;ad[D+32]=o-t;var r=(w+z)*0.707106781;ad[D+16]=z+r;ad[D+48]=z-r;o=a9+O;t=O+R;w=R+Z;var F=(o-w)*0.382683433;var u=0.5411961*o+F;var aa=1.306562965*w+F;var x=t*0.707106781;var ab=Z+x;var Q=Z-x;ad[D+40]=Q+u;ad[D+24]=Q-u;ad[D+8]=ab+aa;ad[D+56]=ab-aa;D++}var L;for(B=0;B<m;++B){L=ad[B]*X[B];ak[B]=(L>0)?((L+0.5)|0):((L-0.5)|0)}return ak}function g(){at(65504);at(16);aP(74);aP(70);aP(73);aP(70);aP(0);aP(1);aP(1);aP(0);at(1);at(1);aP(0);aP(0)}function au(i,j){at(65472);at(17);aP(8);at(j);at(i);aP(3);aP(1);aP(17);aP(0);aP(2);aP(17);aP(1);aP(3);aP(17);aP(1)}function aL(){at(65499);at(132);aP(0);for(var i=0;i<64;i++){aP(a0[i])}aP(1);for(var j=0;j<64;j++){aP(ap[j])}}function aR(){at(65476);at(418);aP(0);for(var n=0;n<16;n++){aP(a1[n+1])}for(var o=0;o<=11;o++){aP(a5[o])}aP(16);for(var p=0;p<16;p++){aP(aC[p+1])}for(var i=0;i<=161;i++){aP(aO[i])}aP(1);for(var j=0;j<16;j++){aP(aE[j+1])}for(var k=0;k<=11;k++){aP(aD[k])}aP(17);for(var l=0;l<16;l++){aP(aT[l+1])}for(var m=0;m<=161;m++){aP(aK[m])}}function aS(){at(65498);at(12);aP(3);aP(1);aP(0);aP(2);aP(17);aP(3);aP(17);aP(0);aP(63);aP(0)}function aX(x,B,p,k,l){var v=l[0];var z=l[240];var y;var j=16;var u=63;var w=64;var i=am(x,B);for(var o=0;o<w;++o){ah[al[o]]=i[o]}var m=ah[0]-p;p=ah[0];if(m==0){aB(k[0])}else{y=32767+m;aB(k[aV[y]]);aB(aq[y])}var A=63;for(;(A>0)&&(ah[A]==0);A--){}if(A==0){aB(v);return p}var n=1;var r;while(n<=A){var q=n;for(;(ah[n]==0)&&(n<=A);++n){}var t=n-q;if(t>=j){r=t>>4;for(var s=1;s<=r;++s){aB(z)}t=t&15}y=32767+ah[n];aB(l[(t<<4)+aV[y]]);aB(aq[y]);n++}if(A!=u){aB(v)}return p}function aF(){var i=String.fromCharCode;for(var j=0;j<256;j++){a2[j]=i(j)}}this.encode=function(m,v){if(v){a4(v)}aY=new Array();ay=0;a6=7;at(65496);g();aL();au(m.width,m.height);aR();aS();var t=0;var l=0;var n=0;ay=0;a6=7;this.encode.displayName="_encode_";var q=m.data;var i=m.width;var o=m.height;var j=i*4;var D=i*3;var w,x=0;var r,s,p;var C,k,A,y,z;while(x<o){w=0;while(w<j){C=j*x+w;k=C;A=-1;y=0;for(z=0;z<64;z++){y=z>>3;A=(z&7)*4;k=C+(y*j)+A;if(x+y>=o){k-=(j*(x+1+y-o))}if(w+A>=j){k-=((w+A)-j+4)}r=q[k++];s=q[k++];p=q[k++];aw[z]=((av[r]+av[(s+256)>>0]+av[(p+512)>>0])>>16)-128;a3[z]=((av[(r+768)>>0]+av[(s+1024)>>0]+av[(p+1280)>>0])>>16)-128;aM[z]=((av[(r+1280)>>0]+av[(s+1536)>>0]+av[(p+1792)>>0])>>16)-128}t=aX(aw,ai,t,az,aQ);l=aX(a3,aG,l,aZ,aN);n=aX(aM,aG,n,aZ,aN);w+=32}x+=8}if(a6>=0){var u=[];u[1]=a6+1;u[0]=(1<<(a6+1))-1;aB(u)}at(65497);var B="data:image/jpeg;base64,"+btoa(aY.join(""));aY=[];return B};function a4(i){if(i<=0){i=1}if(i>100){i=100}if(aA==i){return}var j=0;if(i<50){j=Math.floor(5000/i)}else{j=Math.floor(200-i*2)}an(j);aA=i}function aj(){if(!aW){aW=50}aF();aI();aH();aJ();a4(aW)}aj()}a.encode=function(k,g){var l=new a(g);return l.encode(k)};return a});f("runtime/html5/androidpatch",["runtime/html5/util","runtime/html5/jpegencoder","base"],function(a,b,c){var j=a.canvasToDataUrl,i;a.canvasToDataUrl=function(q,g,t){var r,s,h,v,u;if(!c.os.android){return j.apply(null,arguments)}if(g==="image/jpeg"&&typeof i==="undefined"){v=j.apply(null,arguments);u=v.split(",");if(~u[0].indexOf("base64")){v=atob(u[1])}else{v=decodeURIComponent(u[1])}v=v.substring(0,2);i=v.charCodeAt(0)===255&&v.charCodeAt(1)===216}if(g==="image/jpeg"&&!i){s=q.width;h=q.height;r=q.getContext("2d");return b.encode(r.getImageData(0,0,s,h),t)}return j.apply(null,arguments)}});f("runtime/html5/image",["base","runtime/html5/runtime","runtime/html5/util"],function(h,a,c){var b="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D";return a.register("Image",{modified:false,init:function(){var g=this,j=new Image();j.onload=function(){g._info={type:g.type,width:this.width,height:this.height};if(!g._metas&&"image/jpeg"===g.type){c.parseMeta(g._blob,function(i,l){g._metas=l;g.owner.trigger("load")})}else{g.owner.trigger("load")}};j.onerror=function(){g.owner.trigger("error")};g._img=j},loadFromBlob:function(k){var g=this,l=g._img;g._blob=k;g.type=k.type;l.src=c.createObjectURL(k.getSource());g.owner.once("load",function(){c.revokeObjectURL(l.src)})},resize:function(g,l){var k=this._canvas||(this._canvas=document.createElement("canvas"));this._resize(this._img,k,g,l);this._blob=null;this.modified=true;this.owner.trigger("complete","resize")},crop:function(u,v,s,w,C){var x=this._canvas||(this._canvas=document.createElement("canvas")),B=this.options,y=this._img,z=y.naturalWidth,g=y.naturalHeight,A=this.getOrientation();C=C||1;x.width=s;x.height=w;B.preserveHeaders||this._rotate2Orientaion(x,A);this._renderImageToCanvas(x,y,-u,-v,z*C,g*C);this._blob=null;this.modified=true;this.owner.trigger("complete","crop")},getAsBlob:function(l){var n=this._blob,g=this.options,m;l=l||this.type;if(this.modified||this.type!==l){m=this._canvas;if(l==="image/jpeg"){n=c.canvasToDataUrl(m,l,g.quality);if(g.preserveHeaders&&this._metas&&this._metas.imageHead){n=c.dataURL2ArrayBuffer(n);n=c.updateImageHead(n,this._metas.imageHead);n=c.arrayBufferToBlob(n,l);return n}}else{n=c.canvasToDataUrl(m,l)}n=c.dataURL2Blob(n)}return n},getAsDataUrl:function(j){var g=this.options;j=j||this.type;if(j==="image/jpeg"){return c.canvasToDataUrl(this._canvas,j,g.quality)}else{return this._canvas.toDataURL(j)}},getOrientation:function(){return this._metas&&this._metas.exif&&this._metas.exif.get("Orientation")||1},info:function(g){if(g){this._info=g;return this}return this._info},meta:function(g){if(g){this._meta=g;return this}return this._meta},destroy:function(){var g=this._canvas;this._img.onload=null;if(g){g.getContext("2d").clearRect(0,0,g.width,g.height);g.width=g.height=0;this._canvas=null}this._img.src=b;this._img=this._blob=null},_resize:function(z,x,C,E){var D=this.options,w=z.width,F=z.height,B=this.getOrientation(),A,G,y,g,v;if(~[5,6,7,8].indexOf(B)){C^=E;E^=C;C^=E}A=Math[D.crop?"max":"min"](C/w,E/F);D.allowMagnify||(A=Math.min(1,A));G=w*A;y=F*A;if(D.crop){x.width=C;x.height=E}else{x.width=G;x.height=y}g=(x.width-G)/2;v=(x.height-y)/2;D.preserveHeaders||this._rotate2Orientaion(x,B);this._renderImageToCanvas(x,z,g,v,G,y)},_rotate2Orientaion:function(m,n){var g=m.width,p=m.height,o=m.getContext("2d");switch(n){case 5:case 6:case 7:case 8:m.width=p;m.height=g;break}switch(n){case 2:o.translate(g,0);o.scale(-1,1);break;case 3:o.translate(g,p);o.rotate(Math.PI);break;case 4:o.translate(0,p);o.scale(1,-1);break;case 5:o.rotate(0.5*Math.PI);o.scale(1,-1);break;case 6:o.rotate(0.5*Math.PI);o.translate(0,-p);break;case 7:o.rotate(0.5*Math.PI);o.translate(g,-p);o.scale(-1,1);break;case 8:o.rotate(-0.5*Math.PI);o.translate(-g,0);break}},_renderImageToCanvas:(function(){if(!h.os.ios){return function(i){var m=h.slice(arguments,1),n=i.getContext("2d");n.drawImage.apply(n,m)}}function g(x,A,D){var B=document.createElement("canvas"),C=B.getContext("2d"),u=0,w=D,i=D,y,z,v;B.width=1;B.height=D;C.drawImage(x,0,0);y=C.getImageData(0,0,1,D).data;while(i>u){z=y[(i-1)*4+3];if(z===0){w=i}else{u=i}i=(w+u)>>1}v=(i/D);return(v===0)?1:v}if(h.os.ios>=7){return function(z,x,t,u,s,w){var y=x.naturalWidth,i=x.naturalHeight,v=g(x,y,i);return z.getContext("2d").drawImage(x,0,0,y*v,i*v,t,u,s,w)}}function j(o){var p=o.naturalWidth,r=o.naturalHeight,i,q;if(p*r>1024*1024){i=document.createElement("canvas");i.width=i.height=1;q=i.getContext("2d");q.drawImage(o,-p+1,0);return q.getImageData(0,0,1,1).data[3]===0}else{return false}}return function(U,G,P,R,Q,i){var S=G.naturalWidth,H=G.naturalHeight,O=U.getContext("2d"),V=j(G),X=this.type==="image/jpeg",J=1024,y=0,N=0,W,T,M,I,L,x,K;if(V){S/=2;H/=2}O.save();W=document.createElement("canvas");W.width=W.height=J;T=W.getContext("2d");M=X?g(G,S,H):1;I=Math.ceil(J*Q/S);L=Math.ceil(J*i/H/M);while(y<H){x=0;K=0;while(x<S){T.clearRect(0,0,J,J);T.drawImage(G,-x,-y);O.drawImage(W,0,0,J,J,P+K,R+N,I,L);x+=J;K+=I}y+=J;N+=L}O.restore();W=T=null}})()})});f("runtime/html5/transport",["base","runtime/html5/runtime"],function(h,a){var c=h.noop,b=h.$;return a.register("Transport",{init:function(){this._status=0;this._response=null},send:function(){var t=this.owner,q=this.options,v=this._initAjax(),r=t._blob,g=q.server,p,u,s;if(q.sendAsBinary){g+=(/\?/.test(g)?"&":"?")+b.param(t._formData);u=r.getSource()}else{p=new FormData();b.each(t._formData,function(i,j){p.append(i,j)});p.append(q.fileVal,r.getSource(),q.filename||t._formData.name||"")}if(q.withCredentials&&"withCredentials" in v){v.open(q.method,g,true);v.withCredentials=true}else{v.open(q.method,g)}this._setRequestHeader(v,q.headers);if(u){v.overrideMimeType&&v.overrideMimeType("application/octet-stream");if(h.os.android){s=new FileReader();s.onload=function(){v.send(this.result);s=s.onload=null};s.readAsArrayBuffer(u)}else{v.send(u)}}else{v.send(p)}},getResponse:function(){return this._response},getResponseAsJson:function(){return this._parseJson(this._response)},getStatus:function(){return this._status},abort:function(){var g=this._xhr;if(g){g.upload.onprogress=c;g.onreadystatechange=c;g.abort();this._xhr=g=null}},destroy:function(){this.abort()},_initAjax:function(){var k=this,g=new XMLHttpRequest(),l=this.options;if(l.withCredentials&&!("withCredentials" in g)&&typeof XDomainRequest!=="undefined"){g=new XDomainRequest()}g.upload.onprogress=function(i){var j=0;if(i.lengthComputable){j=i.loaded/i.total}return k.trigger("progress",j)};g.onreadystatechange=function(){if(g.readyState!==4){return}g.upload.onprogress=c;g.onreadystatechange=c;k._xhr=null;k._status=g.status;if(g.status>=200&&g.status<300){k._response=g.responseText;return k.trigger("load")}else{if(g.status>=500&&g.status<600){k._response=g.responseText;return k.trigger("error","server")}}return k.trigger("error",k._status?"http":"abort")};k._xhr=g;return g},_setRequestHeader:function(g,j){b.each(j,function(l,i){g.setRequestHeader(l,i)})},_parseJson:function(g){var k;try{k=JSON.parse(g)}catch(l){k={}}return k}})});f("runtime/html5/md5",["runtime/html5/runtime"],function(c){var C=function(g,h){return(g+h)&4294967295},b=function(g,h,i,j,k,l){h=C(C(h,g),C(j,l));return C((h<<k)|(h>>>(32-k)),i)},F=function(h,i,m,g,j,k,l){return b((i&m)|((~i)&g),h,i,j,k,l)},w=function(h,i,m,g,j,k,l){return b((i&g)|(m&(~g)),h,i,j,k,l)},B=function(h,i,m,g,j,k,l){return b(i^m^g,h,i,j,k,l)},H=function(h,i,m,g,j,k,l){return b(m^(i|(~g)),h,i,j,k,l)},D=function(i,l){var h=i[0],j=i[1],g=i[2],k=i[3];h=F(h,j,g,k,l[0],7,-680876936);k=F(k,h,j,g,l[1],12,-389564586);g=F(g,k,h,j,l[2],17,606105819);j=F(j,g,k,h,l[3],22,-1044525330);h=F(h,j,g,k,l[4],7,-176418897);k=F(k,h,j,g,l[5],12,1200080426);g=F(g,k,h,j,l[6],17,-1473231341);j=F(j,g,k,h,l[7],22,-45705983);h=F(h,j,g,k,l[8],7,1770035416);k=F(k,h,j,g,l[9],12,-1958414417);g=F(g,k,h,j,l[10],17,-42063);j=F(j,g,k,h,l[11],22,-1990404162);h=F(h,j,g,k,l[12],7,1804603682);k=F(k,h,j,g,l[13],12,-40341101);g=F(g,k,h,j,l[14],17,-1502002290);j=F(j,g,k,h,l[15],22,1236535329);h=w(h,j,g,k,l[1],5,-165796510);k=w(k,h,j,g,l[6],9,-1069501632);g=w(g,k,h,j,l[11],14,643717713);j=w(j,g,k,h,l[0],20,-373897302);h=w(h,j,g,k,l[5],5,-701558691);k=w(k,h,j,g,l[10],9,38016083);g=w(g,k,h,j,l[15],14,-660478335);j=w(j,g,k,h,l[4],20,-405537848);h=w(h,j,g,k,l[9],5,568446438);k=w(k,h,j,g,l[14],9,-1019803690);g=w(g,k,h,j,l[3],14,-187363961);j=w(j,g,k,h,l[8],20,1163531501);h=w(h,j,g,k,l[13],5,-1444681467);k=w(k,h,j,g,l[2],9,-51403784);g=w(g,k,h,j,l[7],14,1735328473);j=w(j,g,k,h,l[12],20,-1926607734);h=B(h,j,g,k,l[5],4,-378558);k=B(k,h,j,g,l[8],11,-2022574463);g=B(g,k,h,j,l[11],16,1839030562);j=B(j,g,k,h,l[14],23,-35309556);h=B(h,j,g,k,l[1],4,-1530992060);k=B(k,h,j,g,l[4],11,1272893353);g=B(g,k,h,j,l[7],16,-155497632);j=B(j,g,k,h,l[10],23,-1094730640);h=B(h,j,g,k,l[13],4,681279174);k=B(k,h,j,g,l[0],11,-358537222);g=B(g,k,h,j,l[3],16,-722521979);j=B(j,g,k,h,l[6],23,76029189);h=B(h,j,g,k,l[9],4,-640364487);k=B(k,h,j,g,l[12],11,-421815835);g=B(g,k,h,j,l[15],16,530742520);j=B(j,g,k,h,l[2],23,-995338651);h=H(h,j,g,k,l[0],6,-198630844);k=H(k,h,j,g,l[7],10,1126891415);g=H(g,k,h,j,l[14],15,-1416354905);j=H(j,g,k,h,l[5],21,-57434055);h=H(h,j,g,k,l[12],6,1700485571);k=H(k,h,j,g,l[3],10,-1894986606);g=H(g,k,h,j,l[10],15,-1051523);j=H(j,g,k,h,l[1],21,-2054922799);h=H(h,j,g,k,l[8],6,1873313359);k=H(k,h,j,g,l[15],10,-30611744);g=H(g,k,h,j,l[6],15,-1560198380);j=H(j,g,k,h,l[13],21,1309151649);h=H(h,j,g,k,l[4],6,-145523070);k=H(k,h,j,g,l[11],10,-1120210379);g=H(g,k,h,j,l[2],15,718787259);j=H(j,g,k,h,l[9],21,-343485551);i[0]=C(h,i[0]);i[1]=C(j,i[1]);i[2]=C(g,i[2]);i[3]=C(k,i[3])},G=function(h){var g=[],i;for(i=0;i<64;i+=4){g[i>>2]=h.charCodeAt(i)+(h.charCodeAt(i+1)<<8)+(h.charCodeAt(i+2)<<16)+(h.charCodeAt(i+3)<<24)}return g},u=function(i){var g=[],h;for(h=0;h<64;h+=4){g[h>>2]=i[h]+(i[h+1]<<8)+(i[h+2]<<16)+(i[h+3]<<24)}return g},v=function(g){var m=g.length,o=[1732584193,-271733879,-1732584194,271733878],k,n,h,j,i,l;for(k=64;k<=m;k+=64){D(o,G(g.substring(k-64,k)))}g=g.substring(k-64);n=g.length;h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(k=0;k<n;k+=1){h[k>>2]|=g.charCodeAt(k)<<((k%4)<<3)}h[k>>2]|=128<<((k%4)<<3);if(k>55){D(o,h);for(k=0;k<16;k+=1){h[k]=0}}j=m*8;j=j.toString(16).match(/(.*?)(.{0,8})$/);i=parseInt(j[2],16);l=parseInt(j[1],16)||0;h[14]=i;h[15]=l;D(o,h);return o},a=function(g){var m=g.length,o=[1732584193,-271733879,-1732584194,271733878],k,n,h,j,i,l;for(k=64;k<=m;k+=64){D(o,u(g.subarray(k-64,k)))}g=(k-64)<m?g.subarray(k-64):new Uint8Array(0);n=g.length;h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(k=0;k<n;k+=1){h[k>>2]|=g[k]<<((k%4)<<3)}h[k>>2]|=128<<((k%4)<<3);if(k>55){D(o,h);for(k=0;k<16;k+=1){h[k]=0}}j=m*8;j=j.toString(16).match(/(.*?)(.{0,8})$/);i=parseInt(j[2],16);l=parseInt(j[1],16)||0;h[14]=i;h[15]=l;D(o,h);return o},x=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],z=function(g){var h="",i;for(i=0;i<4;i+=1){h+=x[(g>>(i*8+4))&15]+x[(g>>(i*8))&15]}return h},E=function(h){var g;for(g=0;g<h.length;g+=1){h[g]=z(h[g])}return h.join("")},y=function(g){return E(v(g))},A=function(){this.reset()};if(y("hello")!=="5d41402abc4b2a76b9719d911017c592"){C=function(i,j){var g=(i&65535)+(j&65535),h=(i>>16)+(j>>16)+(g>>16);return(h<<16)|(g&65535)}}A.prototype.append=function(g){if(/[\u0080-\uFFFF]/.test(g)){g=unescape(encodeURIComponent(g))}this.appendBinary(g);return this};A.prototype.appendBinary=function(g){this._buff+=g;this._length+=g.length;var h=this._buff.length,i;for(i=64;i<=h;i+=64){D(this._state,G(this._buff.substring(i-64,i)))}this._buff=this._buff.substr(i-64);return this};A.prototype.end=function(h){var k=this._buff,l=k.length,g,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],j;for(g=0;g<l;g+=1){i[g>>2]|=k.charCodeAt(g)<<((g%4)<<3)}this._finish(i,l);j=!!h?this._state:E(this._state);this.reset();return j};A.prototype._finish=function(i,k){var g=k,h,l,j;i[g>>2]|=128<<((g%4)<<3);if(g>55){D(this._state,i);for(g=0;g<16;g+=1){i[g]=0}}h=this._length*8;h=h.toString(16).match(/(.*?)(.{0,8})$/);l=parseInt(h[2],16);j=parseInt(h[1],16)||0;i[14]=l;i[15]=j;D(this._state,i)};A.prototype.reset=function(){this._buff="";this._length=0;this._state=[1732584193,-271733879,-1732584194,271733878];return this};A.prototype.destroy=function(){delete this._state;delete this._buff;delete this._length};A.hash=function(g,i){if(/[\u0080-\uFFFF]/.test(g)){g=unescape(encodeURIComponent(g))}var h=v(g);return !!i?h:E(h)};A.hashBinary=function(h,i){var g=v(h);return !!i?g:E(g)};A.ArrayBuffer=function(){this.reset()};A.ArrayBuffer.prototype.append=function(j){var g=this._concatArrayBuffer(this._buff,j),h=g.length,i;this._length+=j.byteLength;for(i=64;i<=h;i+=64){D(this._state,u(g.subarray(i-64,i)))}this._buff=(i-64)<h?g.subarray(i-64):new Uint8Array(0);return this};A.ArrayBuffer.prototype.end=function(h){var k=this._buff,l=k.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g,j;for(g=0;g<l;g+=1){i[g>>2]|=k[g]<<((g%4)<<3)}this._finish(i,l);j=!!h?this._state:E(this._state);this.reset();return j};A.ArrayBuffer.prototype._finish=A.prototype._finish;A.ArrayBuffer.prototype.reset=function(){this._buff=new Uint8Array(0);this._length=0;this._state=[1732584193,-271733879,-1732584194,271733878];return this};A.ArrayBuffer.prototype.destroy=A.prototype.destroy;A.ArrayBuffer.prototype._concatArrayBuffer=function(g,i){var h=g.length,j=new Uint8Array(h+i.byteLength);j.set(g);j.set(new Uint8Array(i),h);return j};A.ArrayBuffer.hash=function(i,h){var g=a(new Uint8Array(i));return !!h?g:E(g)};return c.register("Md5",{init:function(){},loadFromBlob:function(n){var p=n.getSource(),m=2*1024*1024,l=Math.ceil(p.size/m),g=0,o=this.owner,j=new A.ArrayBuffer(),h=this,q=p.mozSlice||p.webkitSlice||p.slice,i,k;k=new FileReader();i=function(){var r,s;r=g*m;s=Math.min(r+m,p.size);k.onload=function(t){j.append(t.target.result);o.trigger("progress",{total:n.size,loaded:s})};k.onloadend=function(){k.onloadend=k.onload=null;if(++g<l){setTimeout(i,1)}else{setTimeout(function(){o.trigger("load");h.result=j.end();i=n=p=j=null;o.trigger("complete")},50)}};k.readAsArrayBuffer(q.call(p,r,s))};i()},getResult:function(){return this.result}})});f("runtime/flash/runtime",["base","runtime/runtime","runtime/compbase"],function(n,o,a){var c=n.$,m="flash",l={};function p(){var h;try{h=navigator.plugins["Shockwave Flash"];h=h.description}catch(g){try{h=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(i){h="0.0"}}h=h.match(/\d+/g);return parseFloat(h[0]+"."+h[1],10)}function b(){var k={},g={},r=this.destroy,i=this,h=n.guid("webuploader_");o.apply(i,arguments);i.type=m;i.exec=function(z,q){var A=this,x=A.uid,y=n.slice(arguments,2),B;g[x]=A;if(l[z]){if(!k[x]){k[x]=new l[z](A,i)}B=k[x];if(B[q]){return B[q].apply(B,y)}}return i.flashExec.apply(A,arguments)};function j(z,q){var x=z.type||z,w,y;w=x.split("::");y=w[0];x=w[1];if(x==="Ready"&&y===i.uid){i.trigger("ready")}else{if(g[y]){g[y].trigger(x.toLowerCase(),z,q)}}}d[h]=function(){var q=arguments;setTimeout(function(){j.apply(null,q)},1)};this.jsreciver=h;this.destroy=function(){return r&&r.apply(this,arguments)};this.flashExec=function(x,q){var v=i.getFlash(),w=n.slice(arguments,2);return v.exec(this.uid,x,q,w)}}n.inherits(o,{constructor:b,init:function(){var h=this.getContainer(),i=this.options,g;h.css({position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});g='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+i.swf+'" ';if(n.browser.ie){g+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '}g+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+i.swf+'" /><param name="flashvars" value="uid='+this.uid+"&jsreciver="+this.jsreciver+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';h.html(g)},getFlash:function(){if(this._flash){return this._flash}this._flash=c("#"+this.uid).get(0);return this._flash}});b.register=function(g,h){h=l[g]=n.inherits(a,c.extend({flashExec:function(){var j=this.owner,i=this.getRuntime();return i.flashExec.apply(j,arguments)}},h));return h};if(p()>=11.4){o.addRuntime(m,b)}return b});f("runtime/flash/filepicker",["base","runtime/flash/runtime"],function(c,a){var b=c.$;return a.register("FilePicker",{init:function(l){var i=b.extend({},l),n,m;n=i.accept&&i.accept.length;for(m=0;m<n;m++){if(!i.accept[m].title){i.accept[m].title="Files"}}delete i.button;delete i.id;delete i.container;this.flashExec("FilePicker","init",i)},destroy:function(){this.flashExec("FilePicker","destroy")}})});f("runtime/flash/image",["runtime/flash/runtime"],function(a){return a.register("Image",{loadFromBlob:function(b){var c=this.owner;c.info()&&this.flashExec("Image","info",c.info());c.meta()&&this.flashExec("Image","meta",c.meta());this.flashExec("Image","loadFromBlob",b.uid)}})});f("runtime/flash/transport",["base","runtime/flash/runtime","runtime/client"],function(c,a,h){var b=c.$;return a.register("Transport",{init:function(){this._status=0;this._response=null;this._responseJson=null},send:function(){var r=this.owner,p=this.options,n=this._initAjax(),q=r._blob,o=p.server,g;n.connectRuntime(q.ruid);if(p.sendAsBinary){o+=(/\?/.test(o)?"&":"?")+b.param(r._formData);g=q.uid}else{b.each(r._formData,function(i,j){n.exec("append",i,j)});n.exec("appendBlob",p.fileVal,q.uid,p.filename||r._formData.name||"")}this._setRequestHeader(n,p.headers);n.exec("send",{method:p.method,url:o,forceURLStream:p.forceURLStream,mimeType:"application/octet-stream"},g)},getStatus:function(){return this._status},getResponse:function(){return this._response||""},getResponseAsJson:function(){return this._responseJson},abort:function(){var g=this._xhr;if(g){g.exec("abort");g.destroy();this._xhr=g=null}},destroy:function(){this.abort()},_initAjax:function(){var j=this,g=new h("XMLHttpRequest");g.on("uploadprogress progress",function(i){var l=i.loaded/i.total;l=Math.min(1,Math.max(0,l));return j.trigger("progress",l)});g.on("load",function(){var p=g.exec("getStatus"),n=false,o="",i;g.off();j._xhr=null;if(p>=200&&p<300){n=true}else{if(p>=500&&p<600){n=true;o="server"}else{o="http"}}if(n){j._response=g.exec("getResponse");j._response=decodeURIComponent(j._response);i=d.JSON&&d.JSON.parse||function(l){try{return new Function("return "+l).call()}catch(k){return{}}};j._responseJson=j._response?i(j._response):{}}g.destroy();g=null;return o?j.trigger("error",o):j.trigger("load")});g.on("error",function(){g.off();j._xhr=null;j.trigger("error","http")});j._xhr=g;return g},_setRequestHeader:function(g,j){b.each(j,function(l,i){g.exec("setRequestHeader",l,i)})}})});f("runtime/flash/blob",["runtime/flash/runtime","lib/blob"],function(b,a){return b.register("Blob",{slice:function(c,j){var i=this.flashExec("Blob","slice",c,j);return new a(i.uid,i)}})});f("runtime/flash/md5",["runtime/flash/runtime"],function(a){return a.register("Md5",{init:function(){},loadFromBlob:function(b){return this.flashExec("Md5","loadFromBlob",b.uid)}})});f("preset/all",["base","widgets/filednd","widgets/filepaste","widgets/filepicker","widgets/image","widgets/queue","widgets/runtime","widgets/upload","widgets/validator","widgets/md5","runtime/html5/blob","runtime/html5/dnd","runtime/html5/filepaste","runtime/html5/filepicker","runtime/html5/imagemeta/exif","runtime/html5/androidpatch","runtime/html5/image","runtime/html5/transport","runtime/html5/md5","runtime/flash/filepicker","runtime/flash/image","runtime/flash/transport","runtime/flash/blob","runtime/flash/md5"],function(a){return a});f("webuploader",["preset/all"],function(a){return a});return e("webuploader")});