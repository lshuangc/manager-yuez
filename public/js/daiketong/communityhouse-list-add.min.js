"use strict";var panel={init:function(){$("#communityhouse-list-add").unbind("click").bind("click",this.communityhouseListAdd);$("#communityhouse-second-add").unbind("click").bind("click",this.community_house_Add);$("#communityId").unbind("click").bind("input propertychange",this.changeComn);$("#communityId").unbind("click").bind("focus",this.changeComn);$("#subwayId").unbind("click").bind("input propertychange",this.subway);$("#subwayId").unbind("click").bind("focus",this.subway)},communityhouseListAdd:function(){var a=new FormData(document.getElementById("form-add"));if($("#communityId").val()==""||$("#latestSaleTime").val()==""||$("#firstHandTime").val()==""||$("#averagePrice").val()==""||$("#houseSp").val()==""||$("#subwayId").val()==""){layer.msg("请填写完整后提交!",{icon:1,time:1000});return}$.ajax({type:"post",url:urlScope+"/CommunityDetail/addCommunityDetail",data:a,dataType:"json",processData:false,contentType:false,xhrFields:{withCredentials:true},beforeSend:function(){},success:function(b){if(b.result=="0"){layer.msg("添加小区失败!",{icon:1,time:1000});return}else{if(b.result=="1"){layer.msg("添加小区成功!",{icon:1,time:1000});setTimeout(function(){window.parent.location.reload()},1000)}else{layer.msg("小区信息已经存在，请勿重复添加!",{icon:1,time:1500})}}},error:function(b,d,c){layer.msg("网络错误!",{icon:1,time:1000})}})},community_house_Add:function(){var a=new FormData(document.getElementById("form"));if($("#housePhoto").val()==""||$("#houseName").val()==""||$("#communityId").val()==""||$("#communityHousetypeId").val()==""||$("#houseProportion").val()==""||$("#floorNum").val()==""||$("#houseCode").val()==""||$("#houseUnitPrice").val()==""||$("#housePercentage").val()==""||$("#houseLabel").val()==""){layer.msg("请填写完整后提交!",{icon:1,time:1000});return}$.ajax({type:"post",url:urlScope+"/house/addHouse",data:a,processData:false,contentType:false,xhrFields:{withCredentials:true},beforeSend:function(){},success:function(b){var b=JSON.parse(b);if(b.result!="1"){layer.msg("添加二手房小区失败!",{icon:1,time:1000});return}else{layer.msg("添加二手房小区成功!",{icon:1,time:1000})}},error:function(b,d,c){layer.msg("网络错误!",{icon:1,time:1000})}});window.parent.location.reload()},subway:function(){$(".subwayList").css("display","block");$.ajax({type:"post",url:urlScope+"/Label/findAll",data:{},dataType:"json",success:function(d){var d=d.object;var b="";var a=[];for(var c=0;c<d.length;c++){b+="<li>"+d[c].labelName+"</li>"}a.push(b);$(".subwayList").html(a);$(".subwayList>li").attr("onclick","panel.onblurfu(this)")}})},onblurfu:function(a){if($("#subwayVal").val()==""){$("#subwayId").val(a.textContent);$("#subwayVal").val(a.textContent)}else{if($("#subwayVal").val().indexOf(a.textContent+"")<0){$("#subwayId").val($("#subwayId").val()+","+a.textContent);$("#subwayVal").val($("#subwayVal").val()+","+a.textContent)}$(".subwayList").hide()}},changeComn:function(){$(".communityList").css("display","block");$.ajax({type:"post",url:urlScope+"/Community/findByScreen",data:{name:$("#communityId").val(),page:1,rows:99999999},success:function(e){var c=JSON.parse(e);var b=c.object.data;var a="";for(var d=0;d<b.length;d++){a+="<li value="+b[d].id+">"+b[d].name+"</li>"}$(".communityList").html(a);$(".communityList>li").attr("onclick","panel.onblurfucn(this)")}})},onblurfucn:function(b){$("#communityId").val(b.textContent);$("#communityVal").val(b.value);$(".communityList").hide();var a=b.value;$.ajax({type:"post",url:urlScope+"/CommunityHousetype/getHouseTypesByCommunityId",data:{communityId:a},success:function(g){var d=JSON.parse(g);var c=d.object;if(c){var f="";$("#communityHousetypeId").empty();for(var e=0;e<c.length;e++){f+="<option value="+c[e].id+">"+c[e].housetypeName+"</option>"}$("#communityHousetypeId").append(f)}else{alert("请先给小区添加户型！")}}})}};$(function(){panel.init()});