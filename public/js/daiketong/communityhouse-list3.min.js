var panel_CommunityHouse={init:function(){common.bind_Sanji();this.findAllCommunity3(1)},change_CommunityHouseType:function(b){var a=b.value;switch(a){case"1":this.remove_CommunityHousetypeList();this.findAllCommunity3(1);break;case"2":this.remove_CommunityHousetypeList();break}},btn_findByScreen:function(){var a=$("select[name = communityhouse-type]").val();switch(a){case"1":this.communityHouse_search();break;case"2":this.second_search();break}},findAllCommunity3:function(a){$.ajax({type:"POST",url:urlScope+"/CommunityDetail/findToHouTai",dataType:"json",data:{page:a||1,rows:10,type:2},success:function(c){var b=panel_CommunityHouse.packQueryData_Community(c,a);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel_CommunityHouse.findAllCommunity(d.curr)}}})},error:function(b){layer.msg("网络错误",{icon:1,time:1000})}})},remove_CommunityHousetypeList:function(){$("#CommunityHouse_btn").html(" ");$("#CommunityHouse_table").html(" ")},communityhouseAdd:function(d,b,a,c){layer_show(d,b,a,c)},community_stop_start:function(b,a){switch(a){case 0:layer.confirm("确定要修改为停用吗？",function(c){$.ajax({type:"POST",url:urlScope+"/CommunityDetail/updateCommunityDetail",data:{id:b,detailStatus:1},dataType:"json",success:function(d){if(d.result!="1"){layer.msg("修改为停用失败",{icon:1,time:1000});return}location.replace(location.href)},error:function(d){layer.msg("网络错误!",{icon:1,time:1000})}})});break;case 1:layer.confirm("确定要修改为启用吗？",function(){$.ajax({type:"POST",url:urlScope+"/CommunityDetail/updateCommunityDetail",data:{id:b,detailStatus:0},dataType:"json",success:function(c){if(c.result!="1"){layer.msg("修改为启用失败",{icon:1,time:1000});return}location.replace(location.href)},error:function(c){layer.msg("网络错误!",{icon:1,time:1000})}})});break;case 2:layer.confirm("请仔细确认是否为通过还是驳回？",{btn:["通过","驳回"],title:"审核小区"},function(){$.ajax({type:"POST",url:urlScope+"/CommunityDetail/updateCommunityDetail",data:{id:b,detailStatus:0,reviewInformation:"申请已通过"},dataType:"json",success:function(c){if(c.result!="1"){layer.msg("审核失败",{icon:1,time:1000});return}location.replace(location.href)},error:function(c){layer.msg("网络错误!",{icon:1,time:1000})}})},function(){layer.prompt({title:"请填写未通过理由",formType:2},function(d,c){layer.close(c);$.ajax({type:"POST",url:urlScope+"/CommunityDetail/updateCommunityDetail",data:{id:b,detailStatus:4,reviewInformation:"审核未通过原因："+d},dataType:"json",success:function(e){if(e.result!="1"){layer.msg("驳回失败",{icon:1,time:1000});return}location.replace(location.href)},error:function(e){layer.msg("网络错误!",{icon:1,time:1000})}})})});break}},community_see3:function(b,a){switch(a){case 1:layer.confirm("请先在操作栏将状态修改为启用后，才可查看优惠活动",{shadeClose:true,closeBtn:0,title:"优惠活动提示"});break;case 2:layer.confirm("请先在操作栏将待审核通过，然后在操作栏将状态修改为启用后，才可查看优惠活动",{shadeClose:true,closeBtn:0,title:"优惠活动提示"});case 4:layer.confirm("审核未通过，暂时还不能查看优惠活动",{shadeClose:true,closeBtn:0,title:"优惠活动提示"})}},secondHand_stop_start:function(b,a){switch(a){case 0:layer.confirm("确定要修改为启用吗？",function(c){$.ajax({type:"POST",url:urlScope+"/house/updatHouse",data:{id:b,houseStatus:1},dataType:"json",success:function(d){if(d.result!="1"){layer.msg("修改为启用失败",{icon:1,time:1000});return}layer.msg("修改为启用成功!",{icon:1,time:1000});setTimeout(function(){window.location.reload()},2000)},error:function(d){layer.msg("网络错误!",{icon:1,time:1000})}})});break;case 1:layer.confirm("确定要修改为停用吗？",function(){$.ajax({type:"POST",url:urlScope+"/house/updatHouse",data:{id:b,houseStatus:0},dataType:"json",success:function(c){if(c.result!="1"){layer.msg("修改为停用失败",{icon:1,time:1000});return}layer.msg("修改为停用成功!",{icon:1,time:1000});setTimeout(function(){window.location.reload()},2000)},error:function(c){layer.msg("网络错误!",{icon:1,time:1000})}})});break;case 2:layer.confirm('请填写推荐佣金比例：<br/><br/><input id="housePercentage" type="text" style="height:22px;" /> %',{btn:["通过","取消"],title:"审核小区"},function(){if($("#housePercentage")==""){layer.msg("请填写推荐佣金比例后提交",{icon:1,time:1000});return}$.ajax({type:"POST",url:urlScope+"/house/updatHouse",data:{id:b,houseStatus:0,housePercentage:$("#housePercentage").val()},dataType:"json",success:function(c){if(c.result!="1"){layer.msg("审核失败",{icon:1,time:1000});return}location.replace(location.href)},error:function(c){layer.msg("网络错误!",{icon:1,time:1000})}})});break}},communityHouse_search:function(a){$.ajax({type:"POST",url:urlScope+"/CommunityDetail/findToHouTai",data:{page:a||1,rows:10,startTime:$("#datemin").val(),endTime:$("#datemax").val(),communityName:$("#communityName").val(),provinceCode:$("#sheng").val(),cityCode:$("#shi").val(),countyCode:$("#qu").val(),housetypeId:$("#houseType").val(),detailStatus:$("#detailStatus").val()},dataType:"json",success:function(c){var b=panel_CommunityHouse.packQueryData_Community(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel_CommunityHouse.communityHouse_search(d.curr)}}})},error:function(b){layer.msg("网络错误!",{icon:1,time:1000})}})},second_search:function(a){$.ajax({type:"POST",url:urlScope+"/house/findToBackground",data:{page:a||1,rows:10,startTime:$("#datemin").val(),endTime:$("#datemax").val(),name:$("#communityName").val(),provinceCode:$("#sheng").val(),cityCode:$("#shi").val(),countyCode:$("#qu").val(),housetypeId:$("#houseType").val(),houseStatus:$("#detailStatus").val(),type:2},dataType:"json",success:function(c){var b=panel_CommunityHouse.secondHand_Community(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel_CommunityHouse.second_search(d.curr)}}})},error:function(b){layer.msg("网络错误!",{icon:1,time:1000})}})},detailStatusXuan:function(a){$.ajax({type:"POST",dataType:"json",url:urlScope+"/CommunityDetail/findToHouTai",data:{page:a||1,rows:10,startTime:$("#datemin").val(),endTime:$("#datemax").val(),communityName:$("#communityName").val(),provinceCode:$("#sheng").val(),cityCode:$("#shi").val(),countyCode:$("#qu").val(),housetypeId:$("#houseType").val(),detailStatus:$("#detailStatus").val(),type:2},success:function(c){var b=panel_CommunityHouse.packQueryData_Community(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel_CommunityHouse.detailStatusXuan(d.curr)}}})},error:function(b){layer.msg("网络错误!",{icon:1,time:1000})}})},secondHandStatus:function(a){$.ajax({type:"POST",dataType:"json",url:urlScope+"/house/findToBackground",data:{page:a||1,rows:10,startTime:$("#datemin").val(),endTime:$("#datemax").val(),name:$("#communityName").val(),provinceCode:$("#sheng").val(),cityCode:$("#shi").val(),countyCode:$("#qu").val(),housetypeId:$("#houseType").val(),houseStatus:$("#houseStatus").val()},success:function(b){panel_CommunityHouse.secondHand_Community(b,a)},error:function(b){layer.msg("网络错误!",{icon:1,time:1000})}})},goodActivety_edit:function(d,b,e,a,c){layer_show(d,b,a,c)},packQueryData_Community:function(f,h){if(f.result!="1"){layer.msg("获取数据失败",{icon:1,time:1000});return}var b=f.object;var e=b.data;var c="";for(var d=0;d<e.length;d++){var g="";switch(e[d].detailStatus){case"0":g="启用";break;case"1":g="停用";break;case"2":g="待审核";break;case"4":g="未通过";break}c+='<tr class="text-c"><td>'+(d+1)+'</td><td><img src="'+imgurl+"community/"+e[d].imgUrl+'" ></td><td>'+e[d].name+"</td><td>"+e[d].provinceName+","+e[d].cityName+","+e[d].countyName+","+e[d].address+"</td><td>"+e[d].houseTypeRange+"</td><td>"+e[d].houseProportionRange+"</td><td>"+e[d].averagePrice+"</td><td>"+e[d].houseSp+"</td><td>"+e[d].recommendCommission+"</td><td>"+common.dateFormat(e[d].communityDetailAddtime.time)+"</td><td>"+common.dateFormat(e[d].latestSaleTime.time)+"</td><td>"+common.dateFormat(e[d].firstHandTime.time)+"</td><td>"+e[d].propertyName+"</td><td>"+e[d].devloper+"</td><td>"+e[d].sellerCompanyName+'</td><td class="td-status"><span class="">'+g+"</span><input type=hidden  value="+e[d].detailStatus+' id=proStatusId></td><td class="f-14 product-brand-manage">';if(e[d].detailStatus=="0"||e[d].detailStatus=="1"){c+="<a onClick=panel_CommunityHouse.community_stop_start("+e[d].id+","+e[d].detailStatus+') class="label-success  radius label">修改状态</a>'}if(e[d].detailStatus=="2"){c+="<a onClick=panel_CommunityHouse.community_stop_start("+e[d].id+","+e[d].detailStatus+') class="label-success radius label">待审核</a>'}if(e[d].detailStatus=="4"){c+='<a  class=" radius label">未通过</a>'}c+='</td><td class="td-manage">';if(e[d].detailStatus=="0"){c+='<a href="javascript:;" onclick=panel_CommunityHouse.goodActivety_edit("优惠活动","good-activety2.html?communityId='+e[d].communityId+"&id="+e[d].id+'","1","1000","700") class="label-success  radius label">优惠活动</a>'}if(e[d].detailStatus=="2"||e[d].detailStatus=="1"||e[d].detailStatus=="4"){c+='<a href="javascript:;" onclick=panel_CommunityHouse.community_see3('+e[d].id+","+e[d].detailStatus+') class="label-success radius label">优惠活动</a>'}c+="</td></tr>"}c="</tbody>"+c;$("#CommunityHouse_table").html(c);$(".r > strong").html(b.totalNumber);var a=Math.ceil(b.totalNumber/b.pageSize);return a}};$(function(){panel_CommunityHouse.init();$(document).on("click",".a2",function(){$(this).addClass("btn-primary").siblings().removeClass("btn-primary")});$(document).on("click",".a2:nth-child(2)",function(){$("#xiangmu").hide()})});