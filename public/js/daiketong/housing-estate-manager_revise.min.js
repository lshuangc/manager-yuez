var panel={init:function(){$("#reviseid").val(common.getQueryString("reviseid"));$("#sellersId").unbind("click").bind("input propertychange",this.xiaoshoufang);$("#sellersId").unbind("click").bind("focus",this.xiaoshoufang);$("#imgUrl").change(function(){common.fileType(imgUrl)});$("#revise_add").unbind("click").bind("click",this.reviseAdd);this.revise_describe()},revise_describe:function(){$.ajax({type:"POST",url:urlScope+"/Community/getCommunitiesById",dataType:"json",data:{id:common.getQueryString("reviseid")},success:function(d){if(d.result!="1"){layer.msg("获取数据失败",{icon:1,time:1000});return}var d=d.object;for(var b=0;b<d.length;b++){$("#fengmian").attr("src",imgurl+"community/"+d[b].imgUrl);$('input[name="imgUrl"]').attr("src",imgurl+"community/"+d[b].imgUrl);var a=document.getElementById("sheng");a.options[0]=new Option(d[b].provinceName,d[b].provinceCode);var c=document.getElementById("shi");c.options[0]=new Option(d[b].cityName,d[b].cityCode);var e=document.getElementById("qu");e.options[0]=new Option(d[b].countyName,d[b].countyCode);$("#name").val(d[b].name);$("#address").val(d[b].address);$("#houseTypeRange").val(d[b].houseTypeRange);$("#houseProportionRange").val(d[b].houseProportionRange);$("#propertyId").val(d[b].propertyName);$("#propertyVal").val(d[b].propertyId);$("#devloper").val(d[b].devloper);$("#sellersId").val(d[b].sellerCommpanyName);$("#sellersVal").val(d[b].sellersCompanyId)}},error:function(a){layer.msg("网络错误",{icon:1,time:1000})}})},reviseAdd:function(){if($("#name").val()==""||$("#sheng").val()==""||$("#shi").val()==""||$("#qu").val()==""||$("#address").val()==""||$("#houseTypeRange").val()==""||$("#houseProportionRange").val()==""||$("#propertyId").val()==""||$("#devloper").val()==""||$("#sellersId").val()==""){layer.msg("请填写完整后提交!",{icon:1,time:1000});return}$("#coordinate3").val($("#coordinate").val()+","+$("#coordinate2").val());var a=new FormData(document.getElementById("form-revise"));$.ajax({type:"post",url:urlScope+"/Community/updateCommuity",data:a,dataType:"json",processData:false,contentType:false,xhrFields:{withCredentials:true},beforeSend:function(){},success:function(b){if(b.result!="1"){layer.msg("小区添加失败!",{icon:1,time:1000});return}else{layer.msg("小区添加成功!",{icon:1,time:1000})}window.parent.location.reload()},error:function(b,d,c){layer.msg("网络错误!",{icon:1,time:1000})}})},wuye:function(){$(".propertyList").css("display","block");$.ajax({type:"post",url:urlScope+"/Property/findPropertyByStatus",data:{likeName:$("#propertyId").val()},dataType:"json",success:function(c){var c=c.object;var a="";for(var b=0;b<c.length;b++){a+="<li value="+c[b].propertyId+">"+c[b].propertyName+"</li>"}$(".propertyList").html(a);$(".propertyList>li").attr("onclick","panel.onblurfuc(this)")}})},onblurfuc:function(a){$("#propertyId").val(a.textContent);$("#propertyVal").val(a.value);$(".propertyList").hide()},xiaoshoufang:function(){$(".sellersList").css("display","block");$.ajax({type:"post",url:urlScope+"/sellersCompany/getLikeCompanyName",data:{likeName:$("#sellersId").val()},success:function(c){var c=JSON.parse(c);var c=c.object;var a="";for(var b=0;b<c.length;b++){a+="<li value="+c[b].sellersCompanyId+">"+c[b].companyName+"</li>"}$(".sellersList").html(a);$(".sellersList>li").attr("onclick","panel.onblurfucn(this)")}})},onblurfucn:function(a){$("#sellersId").val(a.textContent);$("#sellersVal").val(a.value);$(".sellersList").hide()}};$(function(){panel.init()});