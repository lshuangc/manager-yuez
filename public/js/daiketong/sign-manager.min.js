var panel={init:function(){this.signPagIng();common.bind_Sanji()},remove_List:function(){$("#tbody").html(" ")},change:function(b){var a=b.value;switch(a){case"1":this.remove_List();this.signPagIng(1);break;case"2":this.remove_List();this.secondHand(1);break}},search:function(){var a=$("select[name = communityhouse-type]").val();switch(a){case"1":this.sign_search();break;case"2":this.two_search();break}},bind_communitySelect:function(b){var a=$(b).val();$.ajax({type:"post",url:urlScope+"/Community/findByScreen",datatype:"json",data:{countyCode:a,page:1,rows:10},success:function(g){var f=JSON.parse(g);var c=document.getElementById("communityId");c.options[0]=new Option("全部"," ");var d=f.object.data;console.log(d.length);for(var e=0;e<d.length;e++){c.options[e+1]=new Option(d[e].name,d[e].id)}},error:function(c){layer.msg("网络错误",{icon:1,time:1000})}})},signPagIng:function(a){$.ajax({type:"post",url:urlScope+"/recommendRecord/houtaiSignedByCommunity",dataType:"json",data:{page:a||1,rows:10},success:function(c){var b=panel.packQueryData(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel.signPagIng(d.curr)}}})},error:function(b){layer.msg("网络错误",{icon:1,time:1000})}})},secondHand:function(a){$.ajax({type:"post",url:urlScope+"/recommendRecord/houtaiByHouse",data:{page:a||1,rows:10},dataType:"json",success:function(c){var b=panel.secondPackQueryData(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel.secondHand(d.curr)}}})},error:function(b){layer.msg("网络错误",{icon:1,time:1000})}})},sign_search:function(a){$.ajax({type:"POST",url:urlScope+"/recommendRecord/houtaiSignedByCommunity",data:{page:a||1,rows:10,startTime:$("#datemin").val(),endTime:$("#datemax").val(),provinceCode:$("#sheng").val(),cityCode:$("#shi").val(),countyCode:$("#qu").val(),communityId:$("#communityId").val()},dataType:"json",success:function(c){var b=panel.packQueryData(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel.sign_search(d.curr)}}})},error:function(b){layer.msg("网络错误!",{icon:1,time:1000})}})},two_search:function(a){$.ajax({type:"POST",url:urlScope+"/recommendRecord/houtaiByHouse",data:{page:a||1,rows:10,startTime:$("#datemin").val(),endTime:$("#datemax").val(),provinceCode:$("#sheng").val(),cityCode:$("#shi").val(),countyCode:$("#qu").val(),communityId:$("#communityId").val(),recommendFlow:9,recommendStatus:3},dataType:"json",success:function(c){var b=panel.secondPackQueryData(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel.two_search(c)(d.curr)}}})},error:function(b){layer.msg("网络错误!",{icon:1,time:1000})}})},signStatus:function(a){$.ajax({type:"POST",dataType:"json",url:urlScope+"/recommendRecord/houtaiSignedByCommunity",data:{page:a||1,rows:10,startTime:$("#datemin").val(),endTime:$("#datemax").val(),provinceCode:$("#sheng").val(),cityCode:$("#shi").val(),countyCode:$("#qu").val(),communityId:$("#communityId").val(),recommendStatus:$("#signId").val(),recommendFlow:$("#signFlow").val()},success:function(c){var b=panel.packQueryData(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel.signStatus(d.curr)}}})},error:function(b){layer.msg("网络错误!",{icon:1,time:1000})}})},describSign:function(d,b,a,c){layer_show(d,b,a,c)},packQueryData:function(g){if(g.result!="1"){layer.msg("获取数据失败",{icon:1,time:1000});return}var d=g.object;var f=d.data;var b="";for(var e=0;e<f.length;e++){var c="";switch(f[e].recommendStatus){case"3":c="签约";break;case"4":c="完成";break}var h="";switch(f[e].recommendFlow){case"9":h="签约单已确认";break;case"10":h="佣金已发放";break}b+='<tr class="text-c"><td>'+(e+1)+"</td><td>"+f[e].recommendUserName+"</td><td>"+f[e].recommendProjectName+"</td><td>"+f[e].recommendUserPhone+"</td><td>"+common.dateFormat(f[e].recommendAddTime.time)+'</td><td class="td-status"><span class="  radius">'+c+'</span> <input type="hidden" value='+f[e].recommendStatus+'> </td><td class="td-status"><span class="  radius">'+h+'</span> <input type="hidden" value='+f[e].recommendFlow+'> </td><td><a href="javascript:;" onclick=panel.describSign("查看详情","sign-manager-describe.html?recordId='+f[e].id+'","800","500") class="label label-success radius">详情</a></td></tr>'}$("tbody").html(b);$(".r > strong").html(d.totalNumber);var a=Math.ceil(d.totalNumber/d.pageSize);return a},secondPackQueryData:function(g){if(g.result!="1"){layer.msg("获取数据失败",{icon:1,time:1000});return}var d=g.object;var f=d.data;var b="";for(var e=0;e<f.length;e++){var c="";switch(f[e].recommendStatus){case"3":c="签约";break}var h="";switch(f[e].recommendFlow){case"9":h="签约单已确认";break}b+='<tr class="text-c"><td>'+(e+1)+"</td><td>"+f[e].id+"</td><td>"+f[e].recommendUserName+"</td><td>"+f[e].recommendProjectName+"</td><td>"+f[e].recommendUserPhone+"</td><td>"+common.dateFormat(f[e].recommendAddTime.time)+'</td><td class="td-status"><span class="radius">'+c+'</span> <input type="hidden" value='+f[e].recommendStatus+'> </td><td class="td-status"><span class="  radius">'+h+'</span> <input type="hidden" value='+f[e].recommendFlow+'> </td><td><a href="javascript:;"  onclick=panel.describSign("查看详情","sign-manager-describe.html?recordId='+f[e].id+'","800","500") class="label label-success radius">详情</a></td></tr>'}$("tbody").html(b);$(".r > strong").html(d.totalNumber);var a=Math.ceil(d.totalNumber/d.pageSize);return a}};$(function(){panel.init();$("#qu").change(function(){panel.bind_communitySelect(this)})});