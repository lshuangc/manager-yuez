"use strict";var panel={init:function(){this.sellerPagIng()},sellerPagIng:function(a){$.ajax({type:"POST",url:urlScope+"/sellersCompany/getAllByConditions",dataType:"json",data:{page:a||1,pageSize:10},success:function(c){var b=panel.packQueryData(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel.sellerPagIng(d.curr)}}})},error:function(b){layer.msg("网络错误",{icon:1,time:1000})}})},seller_search:function(a){$.ajax({type:"POST",url:urlScope+"/sellersCompany/getAllByConditions",data:{page:a||1,pageSize:10,startTime:$("#datemin").val(),endTime:$("#datemax").val(),companyName:$("#sellerName").val(),companyStatus:$("#proState").val()},dataType:"json",success:function(c){var b=panel.packQueryData(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel.seller_search(d.curr)}}})},error:function(b){layer.msg("网络错误!",{icon:1,time:1000})}})},seller_add:function(d,b,a,c){layer_show(d,b,a,c)},shenhe:function(c,b,d,a){switch(b){case 0:layer.confirm("请确认是否通过",{btn:["通过","驳回"],title:"销售商审核"},function(){$.ajax({type:"POST",url:urlScope+"/sellersCompany/updateStatus",data:{status:1,sellersUserId:a,sellersCompanyId:d,sellersUserDescribe:"审核成功"},dataType:"json",success:function(e){if(e.result!="1"){layer.msg("审核失败",{icon:1,time:1000});return}location.replace(location.href);layer.msg("审核成功",{icon:1,time:1000})},error:function(e){layer.msg("网络错误!",{icon:1,time:1000})}})},function(){$.ajax({type:"POST",url:urlScope+"/sellersCompany/updateStatus",data:{status:2,sellersUserId:a,sellersCompanyId:d,sellersUserDescribe:"您的申请无效，请重新提交"},dataType:"json",success:function(e){if(e.result!="1"){layer.msg("驳回失败",{icon:1,time:1000});return}layer.msg("驳回成功",{icon:1,time:1000});location.replace(location.href)},error:function(e){layer.msg("网络错误!",{icon:1,time:1000})}})});break}},leixing:function(a,c,b){c=c=="1"?"2":"1";layer.confirm(c=="1"?"确定要修改成内部公司吗？":"确定要修改为外部公司吗？",function(d){$.ajax({type:"POST",url:urlScope+"/sellersCompany/updateCompanytype",data:{sellersCompanyId:b,companyType:c},dataType:"json",success:function(e){if(e.result!="1"){layer.msg(c=="1"?"修改成内部公司失败":"修改成内部公司失败",{icon:1,time:1000});return}setTimeout(function(){layer.msg(c=="1"?"修改为外部公司成功":"修改为外部公司成功",{icon:1,time:1000})});setTimeout(function(){location.replace(location.href)},2000)},error:function(e){layer.msg("网络错误!",{icon:1,time:1000})}})})},proState:function(a){$.ajax({type:"POST",url:urlScope+"/sellersCompany/getAllByConditions",data:{page:a||1,pageSize:10,startTime:$("#datemin").val(),endTime:$("#datemax").val(),companyName:$("#sellerName").val(),companyStatus:$("#proState").val(),companyType:$("#companyType").val()},dataType:"json",success:function(c){var b=panel.packQueryData(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel.proState(d.curr)}}})},error:function(b){layer.msg("网络错误!",{icon:1,time:1000})}})},packQueryData:function(d){if(d.result!="1"){layer.msg("获取数据失败",{icon:1,time:1000});return}var k=d.object;var d=k.data;var m="";for(var e=0;e<d.length;e++){var b=d[e].sellersUsers;var l="";switch(d[e].companyStatus){case"0":l="待审核";break;case"1":l="启用";break;case"2":l="驳回";break}var f="";switch(d[e].companyType){case"1":f="内部公司";break;case"2":f="外部公司";break}m+='<tr class="text-c"><td>'+(e+1)+'</td><td class="bigImg" data-bigImg="'+imgurl+"merchantsFigure/"+d[e].sellersUserImg+'" data-num="1"><img src="'+imgurl+"merchantsFigure/"+d[e].sellersUserImg+'" ></td><td>'+d[e].companyName+"</td><td >"+d[e].companyAddress+"</td><td >"+d[e].sellersUserLicenseId+"</td><td >"+d[e].sellersUserLegalperson+"</td><td>";for(var c=0;c<b.length;c++){var g=b[c].sellersUserType;var h=b[c].sellersUserId;if(g=="1"){m+=""+b[c].sellersUserName+" , "+b[c].sellersUserPhone+"<br>"}}m+="</td><td >"+d[e].sellersUserDescribe+"</td><td>"+common.dateFormat(d[e].addTime.time)+'</td><td class="td-status"><span class=" ">'+l+"</span><input type=hidden  value="+d[e].companyStatus+'></td><td class="f-14 product-brand-manage">';if(d[e].companyStatus=="0"){m+='<a class="label label-success radius" onClick="panel.shenhe(this,'+d[e].companyStatus+","+d[e].sellersCompanyId+","+h+')" href="javascript:;" title="" style="text-decoration:none" >审核</a>'}if(d[e].companyStatus=="1"){m+='<a class="label href="javascript:;" title="" style="text-decoration:none" >审核通过</a>'}if(d[e].companyStatus=="2"){m+='<a class="label radius"  href="javascript:;" title="" style="text-decoration:none" >已驳回</a>'}m+='</td><td class="td-status"><span class=" ">'+f+"</span><input type=hidden  value="+d[e].companyType+'></td><td class="f-14 product-brand-manage"><a class="label label-success radius" onClick="panel.leixing(this,'+d[e].companyType+","+d[e].sellersCompanyId+')" href="javascript:;" title="" style="text-decoration:none" >修改类型</a></td></tr>'}$("tbody").html(m);$(".r > strong").html(k.totalNumber);var a=Math.ceil(k.totalNumber/k.pageSize);return a}};$(function(){panel.init();$(document).on("click",".bigImg",function(){if($(this).attr("data-num")=="1"){$("#bigImg").css({display:"block",background:"url("+$(this).attr("data-bigImg")+") no-repeat","background-size":"100% 100%"});$(this).attr("data-num","2");$("#zhezhao").show()}});$("#bigImg").click(function(){$(this).hide();$(".bigImg").attr("data-num","1");$("#zhezhao").hide()});$("#zhezhao").click(function(){$(this).hide();$(".bigImg").attr("data-num","1");$("#bigImg").hide()})});