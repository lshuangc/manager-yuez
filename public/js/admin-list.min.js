var panel={init:function(){common.isLogin(common.pageName());this.adminPagIng()},adminPagIng:function(a){$.ajax({type:"POST",url:urlScope+"/admin/getAdminsBypage",dataType:"json",data:{page:a||1,rows:10},success:function(c){var b=panel.packQueryData(c);laypage({cont:$("#pageDiv"),pages:b,skip:true,skin:"#5a98de",groups:5,curr:a||1,jump:function(d,e){if(!e){panel.adminPagIng(d.curr)}}})},error:function(b){layer.msg("网络错误",{icon:1,time:1000})}})},admin_search:function(){$.ajax({type:"POST",url:urlScope+"/admin/getAdminsByConditions",data:{datemin:$("#datemin").val(),datemax:$("#datemax").val(),adminName:$("#adminName").val()},dataType:"json",success:function(f){if(f.result!="1"){layer.msg("获取数据失败",{icon:1,time:1000});return}var b=f.object;var a="";for(var d=0;d<b.length;d++){var g=b[d].adminRole=="1"?g="超级管理员":g="普通管理员";var c=b[d].status=="1"?c="已启用":c="已停用";var e=b[d].status=="1"?"label-success":"";a+='<tr class="text-c"><th>'+(d+1)+"</th><td>"+b[d].adminName+"</td><td>"+b[d].phone+"</td><td>"+b[d].email+"</td><td>"+g+"</td><td>"+common.dateFormat(b[d].addTime.time)+"</td><td>"+b[d].remarks+'</td><td class="td-status"><span class="label '+e+' radius">'+c+'</span></td><td class="td-manage">';if(b[d].adminRole=="1"){a+=""}else{if(b[d].status=="1"){a+='<a onClick="panel.admin_stop_start(this,'+b[d].id+","+b[d].status+')" href="javascript:;" title="停用" style="text-decoration:none" class="label label-success radius" >修改状态</a>&nbsp;&nbsp;'}else{a+='<a onClick="panel.admin_stop_start(this,'+b[d].id+","+b[d].status+')" href="javascript:;" title="启用" style="text-decoration:none" class="label label-success radius" >修改状态</a>&nbsp;&nbsp;'}a+=' <a title="编辑" href="javascript:;" onclick=panel.admin_edit("修改密码","admin-password-edit.html?id='+b[d].id+'","800","500") class="label label-success radius" style="text-decoration:none">修改密码</a>'}a+="</td></tr>"}$("tbody").html(a);$(".r > strong").html(b.length)},error:function(a){layer.msg("网络错误!",{icon:1,time:1000})}})},admin_add:function(d,b,a,c){layer_show(d,b,a,c)},admin_edit:function(d,b,e,a,c){layer_show(d,b,a,c)},admin_stop_start:function(b,c,a){a=a=="1"?"0":"1";layer.confirm(a=="1"?"确定要启用吗？":"确定要停用吗？",function(d){$.ajax({type:"POST",url:urlScope+"/admin/updateAdminStatus",data:{id:c,status:a},dataType:"json",success:function(e){if(e.result!="1"){layer.msg(a=="1"?"启用失败":"停用失败",{icon:1,time:1000});return}setTimeout(function(){layer.msg(a=="0"?"停用成功":"启用成功",{icon:1,time:1000})});setTimeout(function(){location.replace(location.href)},2000)},error:function(e){layer.msg("网络错误!",{icon:1,time:1000})}})})},packQueryData:function(d){if(d.result!="1"){layer.msg("获取数据失败",{icon:1,time:1000});return}var g=d.object;var b=g.data;var j="";for(var e=0;e<b.length;e++){var f=b[e].adminRole=="1"?f="超级管理员":f="普通管理员";var c=b[e].status=="1"?c="已启用":c="已停用";var h=b[e].status=="1"?"label-success":"";j+='<tr class="text-c"><th>'+(e+1)+"</th><td>"+b[e].adminName+"</td><td>"+b[e].phone+"</td><td>"+b[e].email+"</td><td>"+f+"</td><td>"+common.dateFormat(b[e].addTime.time)+"</td><td>"+b[e].remarks+'</td><td class="td-status"><span class="label '+h+' radius">'+c+'</span></td><td class="td-manage">';if(b[e].adminRole=="1"){j+='<a  href="javascript:;" style="text-decoration:none" class="label  radius" >修改状态</a>&nbsp;&nbsp;';j+=' <a title="编辑" href="javascript:;"  class="label  radius" style="text-decoration:none">修改密码</a>'}else{j+='<a onClick="panel.admin_stop_start(this,'+b[e].id+","+b[e].status+')" href="javascript:;" title="停用" style="text-decoration:none" class="label label-success radius" >修改状态</a>&nbsp;&nbsp;';j+=' <a title="编辑" href="javascript:;" onclick=panel.admin_edit("修改密码","admin-password-edit.html?id='+b[e].id+'","800","500") class="label label-success radius" style="text-decoration:none">修改密码</a>'}j+="</td></tr>"}$("tbody").html(j);$(".r > strong").html(g.totalNumber);var a=Math.ceil(g.totalNumber/g.pageSize);return a}};$(function(){panel.init()});